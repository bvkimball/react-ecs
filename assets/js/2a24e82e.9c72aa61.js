/*! For license information please see 2a24e82e.9c72aa61.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{147:function(t,e,n){"use strict";n.r(e),n.d(e,"frontMatter",(function(){return qt})),n.d(e,"metadata",(function(){return Ht})),n.d(e,"toc",(function(){return Zt})),n.d(e,"default",(function(){return Xt}));var r=n(3),i=n(7),o=n(0),a=n.n(o),u=n(161),s=n(188),c=n(162),l=n(174),f=n(166),h=n(4),d=n(163),p=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r))||this,Object(d.a)(Object(f.a)(e),"target",void 0),Object(d.a)(Object(f.a)(e),"distance",1),e}return Object(h.a)(e,t),e}(c.Facet),v=n(230),m=function(t){function e(){return t.apply(this,arguments)||this}return Object(h.a)(e,t),e}(c.Facet),y=Object(o.createContext)(void 0),g=function(t){var e=t.size,n=2*e,r=function(){return new v.Box(-e,-e,n,n)},i=Object(o.useMemo)((function(){return{current:new v.Quadtree(r())}}),[]),u=Object(c.useQuery)((function(t){return t.hasAll(l.a,m)}));return Object(c.useSystem)((function(t){i.current=new v.Quadtree(r()),u.loop([l.a,m],(function(t,e){var n=e[0];if(n){var r=n.object3d.position;i.current.insert(t,new v.Point(r.x,r.y))}}))}),-9999),a.a.createElement(y.Provider,{value:i},t.children)},b=function(){var t=Object(o.useContext)(y);if(!t)throw new Error("useQuadtree must be used within a <Quadtree>");return{findInShape:function(e){return t.current.findInShape(e)},insert:function(e,n){return t.current.insert(e,n)}}},_=function t(e){var n=Object(o.useRef)(),r=Object(c.useEntity)(),i=e.parent||r;return a.a.createElement(c.Entity,null,a.a.createElement(p,{target:e.target,distance:e.distance}),a.a.createElement(m,null),a.a.createElement(l.a,null,a.a.createElement("group",{name:"link",userData:{parent:i}},a.a.createElement("mesh",{name:"link",ref:n,scale:.5,userData:{parent:i}},a.a.createElement("meshPhongMaterial",{color:"red"}),a.a.createElement("sphereBufferGeometry",null)))),e.count>0&&a.a.createElement(t,{parent:i,target:n,distance:e.distance,count:e.count-1}))},w=n(177),x=n(299);class j extends w.InstancedBufferGeometry{constructor(){super(),Object(d.a)(this,"isLineSegmentsGeometry",!0),Object(d.a)(this,"type","LineSegmentsGeometry"),Object(d.a)(this,"boundingBox",null),Object(d.a)(this,"boundingSphere",null),Object(d.a)(this,"box",new w.Box3),Object(d.a)(this,"vector",new w.Vector3);this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new w.Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new w.Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(t){const e=this.attributes.instanceStart,n=this.attributes.instanceEnd;return void 0!==e&&(e.applyMatrix4(t),n.applyMatrix4(t),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(t){let e;if(t instanceof Float32Array)e=t;else{if(!Array.isArray(t))return console.error("LineSegmentsGeometry.setPosition requires either a Float32Array or regular array of numbers"),this;e=new Float32Array(t)}const n=new w.InstancedInterleavedBuffer(e,6,1);return this.setAttribute("instanceStart",new w.InterleavedBufferAttribute(n,3,0)),this.setAttribute("instanceEnd",new w.InterleavedBufferAttribute(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(t){let e;if(t instanceof Float32Array)e=t;else{if(!Array.isArray(t))return console.error("LineSegmentsGeometry.setColors requires either a Float32Array or regular array of numbers"),this;e=new Float32Array(t)}const n=new w.InstancedInterleavedBuffer(e,6,1);return this.setAttribute("instanceColorStart",new w.InterleavedBufferAttribute(n,3,0)),this.setAttribute("instanceColorEnd",new w.InterleavedBufferAttribute(n,3,3)),this}fromWireframeGeometry(t){return this.setPositions(Array.from(t.attributes.position.array)),this}fromEdgesGeometry(t){return this.setPositions(Array.from(t.attributes.position.array)),this}fromMesh(t){return this.fromWireframeGeometry(new w.WireframeGeometry(t.geometry)),this}fromLineSegments(t){const e=t.geometry;return e.isBufferGeometry&&this.setPositions(Array.from(e.attributes.position.array)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new w.Box3);const t=this.attributes.instanceStart,e=this.attributes.instanceEnd;void 0!==t&&void 0!==e&&(this.boundingBox.setFromBufferAttribute(t),this.box.setFromBufferAttribute(e),this.boundingBox.union(this.box))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new w.Sphere),null===this.boundingBox&&this.computeBoundingBox();const t=this.attributes.instanceStart,e=this.attributes.instanceEnd;if(void 0!==t&&void 0!==e){const n=this.boundingSphere.center;this.boundingBox&&this.boundingBox.getCenter(n);let r=0;for(let i=0,o=t.count;i<o;i++)this.vector.fromBufferAttribute(t,i),r=Math.max(r,n.distanceToSquared(this.vector)),this.vector.fromBufferAttribute(e,i),r=Math.max(r,n.distanceToSquared(this.vector));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}}const O={linewidth:{value:1},resolution:{value:new w.Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},dashOffset:{value:0},gapSize:{value:1},opacity:{value:1}};w.ShaderLib.line={uniforms:w.UniformsUtils.merge([w.UniformsLib.common,w.UniformsLib.fog,O]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef ALPHA_TO_COVERAGE\n\n\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\tfloat a = vUv.x;\n\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\tfloat len2 = a * a + b * b;\n\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t}\n\n\t\t\t#else\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};class E extends w.ShaderMaterial{constructor(t={}){super({uniforms:w.UniformsUtils.clone(w.ShaderLib.line.uniforms),vertexShader:w.ShaderLib.line.vertexShader,fragmentShader:w.ShaderLib.line.fragmentShader,clipping:!0}),Object(d.a)(this,"isLineMaterial",!0),Object(d.a)(this,"dashed",!1),Object(d.a)(this,"color",0),Object(d.a)(this,"lineWidth",0),Object(d.a)(this,"dashScale",0),Object(d.a)(this,"dashOffset",0),Object(d.a)(this,"dashSize",0),Object(d.a)(this,"opacity",0),Object(d.a)(this,"resolution",new w.Vector2),Object(d.a)(this,"alphaToCoverage",!1),Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},alphaToCoverage:{enumerable:!0,get:function(){return Boolean("ALPHA_TO_COVERAGE"in this.defines)},set:function(t){Boolean(t)!==Boolean("ALPHA_TO_COVERAGE"in this.defines)&&(this.needsUpdate=!0),t?(this.defines.ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(t)}}class S extends w.Mesh{constructor(t=new j,e=new E({color:16777215*Math.random()})){super(t,e),Object(d.a)(this,"type","LineSegments2"),Object(d.a)(this,"isLineSegments2",!0),Object(d.a)(this,"distStart",new w.Vector3),Object(d.a)(this,"distEnd",new w.Vector3),Object(d.a)(this,"computeLineDistances",()=>{const t=this.geometry,e=t.attributes.instanceStart,n=t.attributes.instanceEnd,r=new Float32Array(2*e.data.count);for(let o=0,a=0,u=e.data.count;o<u;o++,a+=2)this.distStart.fromBufferAttribute(e,o),this.distEnd.fromBufferAttribute(n,o),r[a]=0===a?0:r[a-1],r[a+1]=r[a]+this.distStart.distanceTo(this.distEnd);const i=new w.InstancedInterleavedBuffer(r,2,1);return t.setAttribute("instanceDistanceStart",new w.InterleavedBufferAttribute(i,1,0)),t.setAttribute("instanceDistanceEnd",new w.InterleavedBufferAttribute(i,1,1)),this}),Object(d.a)(this,"rayStart",new w.Vector4),Object(d.a)(this,"rayEnd",new w.Vector4),Object(d.a)(this,"ssOrigin",new w.Vector4),Object(d.a)(this,"ssOrigin3",new w.Vector3),Object(d.a)(this,"mvMatrix",new w.Matrix4),Object(d.a)(this,"line",new w.Line3),Object(d.a)(this,"closestPoint",new w.Vector3),Object(d.a)(this,"raycast",(t,e)=>{null===t.camera&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');const n=t.ray,r=t.camera,i=r.projectionMatrix,o=this.geometry,a=this.material,u=a.resolution,s=a.linewidth+0,c=o.attributes.instanceStart,l=o.attributes.instanceEnd,f=-r.near;n.at(1,new w.Vector3(this.ssOrigin.x,this.ssOrigin.y,this.ssOrigin.z)),this.ssOrigin.w=1,this.ssOrigin.applyMatrix4(r.matrixWorldInverse),this.ssOrigin.applyMatrix4(i),this.ssOrigin.multiplyScalar(1/this.ssOrigin.w),this.ssOrigin.x*=u.x/2,this.ssOrigin.y*=u.y/2,this.ssOrigin.z=0,this.ssOrigin3.set(this.ssOrigin.x,this.ssOrigin.y,this.ssOrigin.z);const h=this.matrixWorld;this.mvMatrix.multiplyMatrices(r.matrixWorldInverse,h);for(let d=0,p=c.count;d<p;d++){this.rayStart.fromBufferAttribute(c,d),this.rayEnd.fromBufferAttribute(l,d),this.rayStart.w=1,this.rayEnd.w=1,this.rayStart.applyMatrix4(this.mvMatrix),this.rayEnd.applyMatrix4(this.mvMatrix);if(this.rayStart.z>f&&this.rayEnd.z>f)continue;if(this.rayStart.z>f){const t=this.rayStart.z-this.rayEnd.z,e=(this.rayStart.z-f)/t;this.rayStart.lerp(this.rayEnd,e)}else if(this.rayEnd.z>f){const t=this.rayEnd.z-this.rayStart.z,e=(this.rayEnd.z-f)/t;this.rayEnd.lerp(this.rayStart,e)}this.rayStart.applyMatrix4(i),this.rayEnd.applyMatrix4(i),this.rayStart.multiplyScalar(1/this.rayStart.w),this.rayEnd.multiplyScalar(1/this.rayEnd.w),this.rayStart.x*=u.x/2,this.rayStart.y*=u.y/2,this.rayEnd.x*=u.x/2,this.rayEnd.y*=u.y/2,this.line.start.set(this.rayStart.x,this.rayStart.y,this.rayStart.z),this.line.start.z=0,this.line.end.set(this.rayEnd.x,this.rayEnd.y,this.rayEnd.z),this.line.end.z=0;const t=this.line.closestPointToPointParameter(this.ssOrigin3,!0);this.line.at(t,this.closestPoint);const r=w.MathUtils.lerp(this.rayStart.z,this.rayEnd.z,t),o=r>=-1&&r<=1,a=this.ssOrigin3.distanceTo(this.closestPoint)<.5*s;if(o&&a){this.line.start.fromBufferAttribute(c,d),this.line.end.fromBufferAttribute(l,d),this.line.start.applyMatrix4(h),this.line.end.applyMatrix4(h);const t=new w.Vector3,r=new w.Vector3;n.distanceSqToSegment(this.line.start,this.line.end,r,t),e.push({distance:n.origin.distanceTo(r),point:r,face:null,faceIndex:d,object:this,uv:void 0,pointOnLine:t})}}})}}class z extends j{constructor(){super(),Object(d.a)(this,"type","LineGeometry"),Object(d.a)(this,"isLineGeometry",!0),Object(d.a)(this,"setColors",t=>{const e=t.length-3,n=new Float32Array(2*e);for(let r=0;r<e;r+=3)n[2*r]=t[r],n[2*r+1]=t[r+1],n[2*r+2]=t[r+2],n[2*r+3]=t[r+3],n[2*r+4]=t[r+4],n[2*r+5]=t[r+5];return super.setColors(n),this}),Object(d.a)(this,"fromLine",t=>{const e=t.geometry;return e.isBufferGeometry&&this.setPositions(Array.from(e.attributes.position.array)),this}),Object(d.a)(this,"copy",()=>this)}setPositions(t){const e=t.length-3,n=new Float32Array(2*e);for(let r=0;r<e;r+=3)n[2*r]=t[r],n[2*r+1]=t[r+1],n[2*r+2]=t[r+2],n[2*r+3]=t[r+3],n[2*r+4]=t[r+4],n[2*r+5]=t[r+5];return super.setPositions(n),this}}class M extends S{constructor(t=new z,e=new E({color:16777215*Math.random()})){super(t,e),Object(d.a)(this,"type","Line2"),Object(d.a)(this,"isLine2",!0)}}const A=Object(o.forwardRef)((function(t,e){let{points:n,color:a="black",vertexColors:u,lineWidth:s,dashed:c}=t,l=Object(i.a)(t,["points","color","vertexColors","lineWidth","dashed"]);const[f]=Object(o.useState)(()=>new M),[h]=Object(o.useState)(()=>new E),[d]=Object(o.useState)(()=>new w.Vector2(512,512)),p=Object(o.useMemo)(()=>{const t=new z,e=n.map(t=>t instanceof w.Vector3?t.toArray():t);if(t.setPositions(e.flat()),u){const e=u.map(t=>t instanceof w.Color?t.toArray():t);t.setColors(e.flat())}return t},[n,u]);return Object(o.useLayoutEffect)(()=>{f.computeLineDistances()},[n,f]),Object(o.useLayoutEffect)(()=>{c?h.defines.USE_DASH="":delete h.defines.USE_DASH,h.needsUpdate=!0},[c,h]),Object(o.createElement)("primitive",Object(r.a)({dispose:void 0,object:f,ref:e},l),Object(o.createElement)("primitive",{dispose:void 0,object:p,attach:"geometry"}),Object(o.createElement)("primitive",Object(r.a)({dispose:void 0,object:h,attach:"material",color:a,vertexColors:Boolean(u),resolution:d,linewidth:s,dashed:c},l)))}));var C,k,T=n(203),I=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r))||this,Object(d.a)(Object(f.a)(e),"direction",new w.Vector3(0,0,1)),Object(d.a)(Object(f.a)(e),"length",20),Object(d.a)(Object(f.a)(e),"intersections",[]),e}return Object(h.a)(e,t),e}(c.Facet),R=function(t){var e=t.organism,n=t.color,o=t.children,u=Object(i.a)(t,["organism","color","children"]),s=new w.Layers;return s.set(1),a.a.createElement(c.Entity,{key:Math.random(),type:"eater"},a.a.createElement(I,null),a.a.createElement(I,{direction:new w.Vector3(.1,0,1)}),a.a.createElement(I,{direction:new w.Vector3(-.1,0,1)}),a.a.createElement(I,{direction:new w.Vector3(.5,0,1)}),a.a.createElement(I,{direction:new w.Vector3(-.5,0,1)}),a.a.createElement(I,{direction:new w.Vector3(.8,0,1)}),a.a.createElement(I,{direction:new w.Vector3(-.8,0,1)}),a.a.createElement(N,null),a.a.createElement(L,{organism:e,network:e.getNetwork(),fitness:0}),a.a.createElement(V,null),a.a.createElement(D,null),a.a.createElement(T.d,null),a.a.createElement(l.a,null,a.a.createElement(x.a,Object(r.a)({name:"eater",castShadow:!0,receiveShadow:!0},u),a.a.createElement("meshPhongMaterial",{color:n||"green"}),a.a.createElement(A,{layers:s,points:[[0,0,0],[0,0,5]]}),a.a.createElement(A,{layers:s,points:[[0,0,0],[-5,0,5]]}),a.a.createElement(A,{layers:s,points:[[0,0,0],[5,0,5]]}))),a.a.createElement(St,null),a.a.createElement(zt,null),o)},P=Object(o.createContext)(null),B=function(t){var e=t.inputs,n=t.outputs,r=t.children,o=Object(i.a)(t,["inputs","outputs","children"]),u=mt(e,n,o),s=u[0],c=u[1],l=u[2],f=r[r.length-1];return console.log("Rendering gen "+c+", population "+s.organisms.length),a.a.createElement(P.Provider,{value:{inputs:e,outputs:n,population:s,generation:c,epoch:l}},r.length>1&&r.slice(0,-1),s.organisms.map(f))},F=function(t){function e(){return t.apply(this,arguments)||this}return Object(h.a)(e,t),e}(c.Facet),N=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r))||this,Object(d.a)(Object(f.a)(e),"distance",void 0),Object(d.a)(Object(f.a)(e),"object",void 0),e}return Object(h.a)(e,t),e}(c.Facet),L=(c.Facet,function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r))||this,Object(d.a)(Object(f.a)(e),"organism",void 0),Object(d.a)(Object(f.a)(e),"network",void 0),Object(d.a)(Object(f.a)(e),"fitness",0),Object(d.a)(Object(f.a)(e),"input",{}),Object(d.a)(Object(f.a)(e),"output",{}),e}return Object(h.a)(e,t),e}(c.Facet)),D=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r))||this,Object(d.a)(Object(f.a)(e),"amount",1),e}return Object(h.a)(e,t),e}(c.Facet),V=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r))||this,Object(d.a)(Object(f.a)(e),"amount",1),e}return Object(h.a)(e,t),e}(c.Facet);class U{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.from=e,this.to=n,this.weight=r,this.enabled=i,this.innovation=t}disable(){this.enabled=!1}copy(){return new U(this.innovation,this.from,this.to,this.weight,this.enabled)}}function G(t,e,n,r,i,o,a){try{var u=t[o](a),s=u.value}catch(c){return void n(c)}u.done?e(s):Promise.resolve(s).then(r,i)}function W(t,e){return q(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(s){i=!0,o=s}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}(t,e)||H()}function Q(t){return q(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||H()}function q(t){if(Array.isArray(t))return t}function H(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}class Z{constructor(){this.organisms=[],this.extinct=!1,this.age=0,this.ageOfLastImprovement=0,this.maxFitness=0,this.averageFitness=0,this.expectedOffspring=0}addOrganism(t){this.specimen||(this.specimen=t),this.organisms.push(t),t.species=this}removeOrganism(t){const e=this.organisms.indexOf(t);~e&&this.organisms.splice(e,1)}getSpecimen(){return this.specimen}getChampion(){return this.organisms[0]}adjustFitness(t){let e=0;this.extinct=!!(this.age-this.ageOfLastImprovement+1>t.dropoffAge),this.organisms.forEach(n=>{n.originalFitness=n.fitness,this.extinct&&(n.fitness*=.01),this.age<=10&&(n.fitness*=t.ageSignificance),n.fitness=Math.max(n.fitness,1e-4)/this.organisms.length,e+=n.originalFitness}),this.organisms.sort(ot(t=>t.fitness));var n=W($(this.organisms,1),1);this.specimen=n[0],this.averageFitness=e/this.organisms.length,this.organisms[0].originalFitness>this.maxFitness&&(this.maxFitness=this.organisms[0].originalFitness,this.ageOfLastImprovement=this.age);for(let r=Math.floor(this.organisms.length*t.survivalThreshold+1);r<this.organisms.length;r++)this.organisms[r].kill=!0}reproduce(t,e,n,r){const i=this.organisms,o=this.expectedOffspring;if(o&&!i.length)return;const a=Q(i).slice(0),u=a[0];let s=!1,c=n.getSuperChamp();for(let l=0;l<o;l++){let i;if(c&&c===u&&c.expectedOffspring>0){let n=c.copy(0,e);1===c.expectedOffspring&&(n=nt(t,n)),c.expectedOffspring--,i=n}else if(!s&&o>5)i=u.copy(0,e),s=!0;else if(X()<t.mutateOnlyProbability){i=nt(t,W($(a,1),1)[0].copy(0,e))}else{const e=W($(a,1),1)[0];let n;if(X()>t.interspeciesMateRate){n=W($(a,1),1)[0]}else{let t=0,e=this;for(;e===this&&t++<5;){const t=rt(r);t.organisms.length&&(e=t)}n=e.getChampion()}i=et(n,e,t),(X()<t.mutateOnlyProbability||0===J(e,n,t))&&nt(t,i)}i.generation=e,it(t,i,n.species)}}}function $(t,e){let n=[],r=[...t];for(e=Math.min(e,t.length);n.length<e;){let t=Math.floor(X(r.length));n.push(...r.splice(t,1))}return n}function X(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.random()*(t-e)+e}function Y(){const t=[8,4,4,4,12].map(t=>{let e=Array(t);for(let n=0;n<t;n++)e[n]=15*Math.random()>>>0;return e});return t[2][0]&=3,t[2][1]|=8,t[3][0]=4,t.map(t=>t.map(t=>t.toString(16)).join("")).join("-")}function J(t,e,n){let r=new Set([...t.connections.keys(),...e.connections.keys()]),i=Math.abs(t.connections.size-e.connections.size),o=-i,a=[],u=Math.max(t.connections.size,e.connections.size,1);return r.forEach(n=>{const r=t.connections.get(n),i=e.connections.get(n);r&&i?a.push(Math.abs(r.weight-i.weight)):r&&i||o++}),(i*n.excessCoefficient+o*n.disjointCoefficient)/u+function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length?e.reduce((t,e)=>t+e,0)/e.length:0}(...a)*n.weightDifferenceCoefficient}function K(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4.924273;return 1/(1+Math.exp(-e*t))}function tt(t,e){const n=t.from,r=[t];for(;r.length;){if((t=r.shift()).to.id===n.id)return!0;r.push(...e.filter(e=>e.from.id===t.to.id))}return!1}function et(t,e,n){const r=new dt,i=W([t,e].sort(ot(t=>t.fitness)),2),o=i[0],a=i[1];let u=new Set([...o.connections.keys(),...a.connections.keys()]);return o.nodes.forEach(t=>{(ut(t)||st(t))&&r.addNode(t.copy())}),Array.from(u.values()).sort(at()).forEach(t=>{const e=o.connections.get(t),i=a.connections.get(t),u=e&&i?Math.random()>.5&&n.feedForwardOnly&&!tt(e,r.getConnections())?e.copy():i.copy():(e||i).copy();n.feedForwardOnly&&tt(u,r.getConnections())||(r.connections.set(t,u),u.from=u.from.copy(),u.to=u.to.copy(),r.addNode(u.from),r.addNode(u.to))}),r}function nt(t,e){return X()<t.mutateAddNodeProbability?e.mutateAddNode(t):X()<t.mutateAddConnectionProbability?e.mutateAddConnection(t):(X()<t.mutateConnectionWeightsProbability&&e.mutateConnectionsWeights(t),X()<t.mutateToggleEnableProbability&&e.mutateToggleEnable(),X()<t.reEnableGeneProbability&&e.reEnableGene()),e}function rt(t){const e=Math.min(Math.round(function*(){let t,e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;for(;;){do{e=X(1,-1),t=X(1,-1),n=t**2+e**2}while(0===n||n>=1);n=Math.sqrt(-2*Math.log(n)/n),yield n*t*i+r,yield n*e*i+r}}().next().value),1);return t[function(t,e,n){const r=e-t+1;return((n-t)%r+r)%r+t}(0,t.length-1,e)]}function it(t,e,n){const r=t.compatibilityThreshold;if(!(n.length>0&&n.some(n=>{if(!n.organisms.length)return!1;const i=J(e,n.getSpecimen(),t)<r;return i&&n.addOrganism(e),i}))){const t=new Z;t.addOrganism(e),n.push(t)}}function ot(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t=>t;return(e,n)=>t(n)-t(e)}function at(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t=>t;return(e,n)=>t(e)-t(n)}!function(t){t[t.Bias=0]="Bias",t[t.Input=1]="Input",t[t.Hidden=2]="Hidden",t[t.Output=3]="Output"}(C||(C={})),function(t){t[t.Neuron=0]="Neuron",t[t.Sensor=1]="Sensor"}(k||(k={}));const ut=t=>t.type===C.Input||t.type===C.Bias,st=t=>t.type===C.Output;class ct{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y();this.id=e,this.type=t}copy(){return new ct(this.type,this.id)}}class lt{constructor(t,e){this.value=0,this.bias=0,this.in=[],this.out=[],this.type=t,this.id=e}}class ft{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.weight=0,this.enabled=!0,this.from=t,this.to=e,this.weight=n,this.enabled=r}}class ht{constructor(t,e){this.neurons=new Map,this.activation=K;const n=[],r=[];t.forEach(t=>{let e=t.type,i=t.id;const o=new lt(e,i);switch(this.neurons.set(i,o),e){case C.Bias:case C.Input:n.push(o);break;case C.Output:r.push(o)}}),e.forEach(t=>{let e=t.from,n=t.to,r=t.weight,i=t.enabled;const o=this.neurons.get(e),a=this.neurons.get(n),u=new ft(o,a,r,i);o.out.push(u),a.in.push(u)}),this.inputs=n,this.outputs=r}toJSON(){const t=this.neurons,e=[],n=[];return t.forEach(t=>{let r=t.id,i=t.bias,o=t.type,a=t.out;e.push({id:r,bias:i,type:o}),n.push(...a.map(t=>{let e=t.from,n=t.to,r=t.weight,i=t.enabled;return{from:e.id,to:n.id,weight:r,enabled:i}}))}),{neurons:e,links:n}}activate(t){this.inputs.map((e,n)=>{e.value=t[n]});const e=new Set,n=[...this.inputs],r={};for(;n.length;){const t=n.shift();if(!e.has(t)){if(t.in.length){const e=t.in.filter(t=>t.enabled).reduce((t,e)=>t+e.from.value*e.weight,0);r[t.id]=(r[t.id]||0)+e}e.add(t),n.push(...t.out.filter(t=>t.enabled).map(t=>t.to))}}return this.neurons.forEach(t=>{t.id in r&&(t.value=this.activation(r[t.id]+t.bias))}),this.outputs}}class dt extends class{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y();this.connections=new Map,this.nodes=new Map,this.id=t}copy(){const t=new this.constructor;return this.connections.forEach((e,n)=>{t.connections.set(n,e.copy())}),this.nodes.forEach((e,n)=>{t.nodes.set(n,e.copy())}),t}getConnections(){return Array.from(this.connections.values()).filter(t=>t.enabled)}connectionExists(t,e){return Array.from(this.connections.values()).some(n=>n.from.id===t.id&&n.to.id===e.id)}addConnection(t){this.connections.set(t.innovation,t)}addNode(t){this.nodes.has(t.id)||this.nodes.set(t.id,t)}mutateAddConnection(t){let e=t.addConnectionTries,n=Array.from(this.nodes.values());const r=Array.from(this.connections.values());for(;e--;){const e=W($(n.filter(t=>!st(t)),1),1)[0],i=W($(n.filter(t=>!ut(t)&&t!==e&&(e.type!==C.Output||t.type!==C.Output)),1),1)[0],o=new U(t.innovation.next().value,e,i,X(t.mutationPower,-t.mutationPower));if(!(this.connectionExists(e,i)||t.feedForwardOnly&&tt(o,r)))return void this.addConnection(o)}}mutateAddNode(t){if(!this.connections.size)return;const e=W($(this.getConnections(),1),1)[0],n=new ct(C.Hidden);e.disable(),this.addConnection(new U(t.innovation.next().value,e.from,n)),this.addConnection(new U(t.innovation.next().value,n,e.to,e.weight)),this.addNode(n)}reEnableGene(){for(const t of this.connections.values())if(!t.enabled)return void(t.enabled=!0)}mutateToggleEnable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const e=Array.from(this.connections.values());for(;t--;){const t=W($(e,1),1)[0];if(t.enabled){const n=e.some(e=>e.from!==t.from||!e.enabled||e.innovation===t.innovation);t.enabled=!n}else t.enabled=!0}}mutateConnectionsWeights(t){let e=t.mutationPower,n=t.genomeWeightPerturbated;this.connections.forEach(t=>{const r=X(e,-e);t.enabled&&(X()<n?t.weight+=r:t.weight=r)})}}{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super(),this.originalFitness=0,this.kill=!1,this.generation=0,this.expectedOffspring=0,this.fitness=t,this.generation=e}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=super.copy();return n.fitness=t,n.originalFitness=this.originalFitness,n.generation=e,n}getNetwork(){if(!this.network){const t=Array.from(this.nodes.values()).map(t=>({type:t.type,id:t.id})),e=Array.from(this.connections.values()).sort(at(t=>t.innovation)).map(t=>{let e=t.from,n=t.to,r=t.weight,i=t.enabled;return{from:e.id,to:n.id,weight:r,enabled:i}});this.network=new ht(t,e)}return this.network}}class pt{constructor(t){this.species=[],this.organisms=[],this.generation=1,this.size=t.populationSize,this.config=t}save(){console.error("not implemented")}static from(t,e){let n=e.nodes,r=e.connections;const i=new pt(t),o=new dt;n.forEach(o.addNode.bind(o)),r.forEach(o.addConnection.bind(o));const a=t.populationSize;for(let u=0;u<a;u++){const e=o.copy();e.mutateConnectionsWeights(t),i.addOrganism(e)}return i.speciate(),i}getSuperChamp(){return this.organisms.length?this.organisms.reduce((t,e)=>e.originalFitness>t.originalFitness?e:t):null}addOrganism(t){this.organisms.push(t)}removeOrganism(t){const e=this.organisms.indexOf(t);~e&&this.organisms.splice(e,1)}speciate(){this.organisms.forEach(t=>it(this.config,t,this.species))}epoch(){this.generation++;const t=this.species,e=this.config,n=this.generation,r=[...this.organisms];e.adjustCompatibilityThreshold&&t.length!==e.compatibilityModifierTarget&&(e.compatibilityThreshold+=-e.compatibilityModifier*(t.length>e.compatibilityModifierTarget?-1:1),e.compatibilityThreshold=Math.max(e.compatibilityThreshold,e.compatibilityModifier));let i=0;t.forEach(t=>{t.adjustFitness(e),i+=t.averageFitness}),r.forEach((t,e)=>{t.kill?(this.removeOrganism(t),t.species.removeOrganism(t)):t.expectedOffspring=Math.round(t.originalFitness/i)});const o=[...t].sort(ot(t=>t.maxFitness));o.forEach(t=>{t.expectedOffspring=Math.round(t.averageFitness/i*this.size),t.reproduce(e,n,this,o)}),[...this.organisms].forEach(t=>{this.removeOrganism(t),t.species.removeOrganism(t)}),this.species=t.filter(t=>!!t.organisms.length&&(this.organisms.push(...t.organisms),t.age++,!0))}run(t){var e=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new Promise(function(){var i,o=(i=function*(i,o){const a=e.config;for(;!Number.isFinite(n)||n--;){for(const n of e.organisms){const r=n.getNetwork();if(n.fitness=yield t(r,n,e),n.fitness>=a.fitnessThreshold)return i(n)}e.epoch(),r&&(yield new Promise(t=>setTimeout(t,r)))}o()},function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function a(t){G(o,n,r,a,u,"next",t)}function u(t){G(o,n,r,a,u,"throw",t)}a(void 0)}))});return function(t,e){return o.apply(this,arguments)}}())}}const vt={dropoffAge:15,excessCoefficient:1,disjointCoefficient:1,weightDifferenceCoefficient:1,compatibilityThreshold:3,compatibilityModifier:.3,compatibilityModifierTarget:10,adjustCompatibilityThreshold:!1,mutationPower:2.5,reEnableGeneProbability:.05,mutateConnectionWeightsProbability:.9,genomeWeightPerturbated:.9,ageSignificance:1,survivalThreshold:.2,populationSize:100,mutateOnlyProbability:.2,mutateAddNodeProbability:.03,mutateAddConnectionProbability:.05,mutateToggleEnableProbability:0,interspeciesMateRate:.001,fitnessThreshold:.9,addConnectionTries:20,innovation:function*(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;for(;;)yield t++}(),feedForwardOnly:!0};var mt=function(t,e,n){var r=Object(o.useMemo)((function(){var r=Object.assign({},vt,n),i=[].concat(t,e),o=[];return t.forEach((function(t,n){e.forEach((function(e,r){console.log('Connecting: "'+t.id+'" => "'+e.id+'"'),o.push(new U(n+1e4*r,t,e,0))}))})),pt.from(r,{nodes:i,connections:o})}),[]),i=Object(o.useState)(0),a=i[0],u=i[1];return[r,a,function(){r.epoch(),u((function(t){return t+1}))}]},yt=n(220);class gt{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}}const bt=[];for(let Yt=0;Yt<256;Yt++)bt[Yt]=(Yt<16?"0":"")+Yt.toString(16);let _t=1234567;const wt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(bt[255&t]+bt[t>>8&255]+bt[t>>16&255]+bt[t>>24&255]+"-"+bt[255&e]+bt[e>>8&255]+"-"+bt[e>>16&15|64]+bt[e>>24&255]+"-"+bt[63&n|128]+bt[n>>8&255]+"-"+bt[n>>16&255]+bt[n>>24&255]+bt[255&r]+bt[r>>8&255]+bt[r>>16&255]+bt[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:function(t,e,n){return(1-n)*t+n*e},damp:function(t,e,n,r){return wt.lerp(t,e,1-Math.exp(-n*r))},pingpong:function(t,e=1){return e-Math.abs(wt.euclideanModulo(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(_t=t%2147483647),_t=16807*_t%2147483647,(_t-1)/2147483646},degToRad:function(t){return t*wt.DEG2RAD},radToDeg:function(t){return t*wt.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,r,i){const o=Math.cos,a=Math.sin,u=o(n/2),s=a(n/2),c=o((e+r)/2),l=a((e+r)/2),f=o((e-r)/2),h=a((e-r)/2),d=o((r-e)/2),p=a((r-e)/2);switch(i){case"XYX":t.set(u*l,s*f,s*h,u*c);break;case"YZY":t.set(s*h,u*l,s*f,u*c);break;case"ZXZ":t.set(s*f,s*h,u*l,u*c);break;case"XZX":t.set(u*l,s*p,s*d,u*c);break;case"YXY":t.set(s*d,u*l,s*p,u*c);break;case"ZYZ":t.set(s*p,s*d,u*l,u*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}};class xt{constructor(t=0,e=0,n=0,r=1){this._x=t,this._y=e,this._z=n,this._w=r}static slerp(t,e,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,r)}static slerpFlat(t,e,n,r,i,o,a){let u=n[r+0],s=n[r+1],c=n[r+2],l=n[r+3];const f=i[o+0],h=i[o+1],d=i[o+2],p=i[o+3];if(0===a)return t[e+0]=u,t[e+1]=s,t[e+2]=c,void(t[e+3]=l);if(1===a)return t[e+0]=f,t[e+1]=h,t[e+2]=d,void(t[e+3]=p);if(l!==p||u!==f||s!==h||c!==d){let t=1-a;const e=u*f+s*h+c*d+l*p,n=e>=0?1:-1,r=1-e*e;if(r>Number.EPSILON){const i=Math.sqrt(r),o=Math.atan2(i,e*n);t=Math.sin(t*o)/i,a=Math.sin(a*o)/i}const i=a*n;if(u=u*t+f*i,s=s*t+h*i,c=c*t+d*i,l=l*t+p*i,t===1-a){const t=1/Math.sqrt(u*u+s*s+c*c+l*l);u*=t,s*=t,c*=t,l*=t}}t[e]=u,t[e+1]=s,t[e+2]=c,t[e+3]=l}static multiplyQuaternionsFlat(t,e,n,r,i,o){const a=n[r],u=n[r+1],s=n[r+2],c=n[r+3],l=i[o],f=i[o+1],h=i[o+2],d=i[o+3];return t[e]=a*d+c*l+u*h-s*f,t[e+1]=u*d+c*f+s*l-a*h,t[e+2]=s*d+c*h+a*f-u*l,t[e+3]=c*d-a*l-u*f-s*h,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,r=t._y,i=t._z,o=t._order,a=Math.cos,u=Math.sin,s=a(n/2),c=a(r/2),l=a(i/2),f=u(n/2),h=u(r/2),d=u(i/2);switch(o){case"XYZ":this._x=f*c*l+s*h*d,this._y=s*h*l-f*c*d,this._z=s*c*d+f*h*l,this._w=s*c*l-f*h*d;break;case"YXZ":this._x=f*c*l+s*h*d,this._y=s*h*l-f*c*d,this._z=s*c*d-f*h*l,this._w=s*c*l+f*h*d;break;case"ZXY":this._x=f*c*l-s*h*d,this._y=s*h*l+f*c*d,this._z=s*c*d+f*h*l,this._w=s*c*l-f*h*d;break;case"ZYX":this._x=f*c*l-s*h*d,this._y=s*h*l+f*c*d,this._z=s*c*d-f*h*l,this._w=s*c*l+f*h*d;break;case"YZX":this._x=f*c*l+s*h*d,this._y=s*h*l+f*c*d,this._z=s*c*d-f*h*l,this._w=s*c*l-f*h*d;break;case"XZY":this._x=f*c*l-s*h*d,this._y=s*h*l-f*c*d,this._z=s*c*d+f*h*l,this._w=s*c*l+f*h*d;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],r=e[4],i=e[8],o=e[1],a=e[5],u=e[9],s=e[2],c=e[6],l=e[10],f=n+a+l;if(f>0){const t=.5/Math.sqrt(f+1);this._w=.25/t,this._x=(c-u)*t,this._y=(i-s)*t,this._z=(o-r)*t}else if(n>a&&n>l){const t=2*Math.sqrt(1+n-a-l);this._w=(c-u)/t,this._x=.25*t,this._y=(r+o)/t,this._z=(i+s)/t}else if(a>l){const t=2*Math.sqrt(1+a-n-l);this._w=(i-s)/t,this._x=(r+o)/t,this._y=.25*t,this._z=(u+c)/t}else{const t=2*Math.sqrt(1+l-n-a);this._w=(o-r)/t,this._x=(i+s)/t,this._y=(u+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(wt.clamp(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const r=Math.min(1,e/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,u=e._y,s=e._z,c=e._w;return this._x=n*c+o*a+r*s-i*u,this._y=r*c+o*u+i*a-n*s,this._z=i*c+o*s+n*u-r*a,this._w=o*c-n*a-r*u-i*s,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,r=this._y,i=this._z,o=this._w;let a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;const u=1-a*a;if(u<=Number.EPSILON){const t=1-e;return this._w=t*o+e*this._w,this._x=t*n+e*this._x,this._y=t*r+e*this._y,this._z=t*i+e*this._z,this.normalize(),this._onChangeCallback(),this}const s=Math.sqrt(u),c=Math.atan2(s,a),l=Math.sin((1-e)*c)/s,f=Math.sin(e*c)/s;return this._w=o*l+this._w*f,this._x=n*l+this._x*f,this._y=r*l+this._y*f,this._z=i*l+this._z*f,this._onChangeCallback(),this}slerpQuaternions(t,e,n){this.copy(t).slerp(e,n)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}xt.prototype.isQuaternion=!0;class jt{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Et.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Et.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this}applyQuaternion(t){const e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,u=t.w,s=u*e+o*r-a*n,c=u*n+a*e-i*r,l=u*r+i*n-o*e,f=-i*e-o*n-a*r;return this.x=s*u+f*-i+c*-a-l*-o,this.y=c*u+f*-o+l*-i-s*-a,this.z=l*u+f*-a+s*-o-c*-i,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,u=e.z;return this.x=r*u-i*a,this.y=i*o-n*u,this.z=n*a-r*o,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return Ot.copy(this).projectOnVector(t),this.sub(Ot)}reflect(t){return this.sub(Ot.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(wt.clamp(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const r=Math.sin(e)*t;return this.x=r*Math.sin(n),this.y=Math.cos(e)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}jt.prototype.isVector3=!0;const Ot=new jt,Et=new xt;var St=Object(yt.a)((function(){var t=Object(c.useEntity)(),e=Object(c.useFacet)(l.a),n=Object(c.useStatefulRef)([]),r=n[0],i=n[1],u=new gt;return u.set(1),Object(c.useSystem)((function(n){var a=t.get(I);if(e&&e.object3d&&a)for(var u=0;a;){var s=r.current[u];if(void 0===s)r.current.push(Object(o.createRef)()),i(r.current);else if(s.current&&e.object3d)if(0===a.intersections.filter((function(t){return"food"===t.object.name})).length)s.current.visible=!1;else{s.current.visible=!0;var c=s.current,l=e.object3d.localToWorld(a.direction.clone()).clone().sub(e.object3d.position);c.position.copy(e.object3d.position),c.setDirection(l),c.setLength(a.length,0,0)}u++,a=a.next}})),a.a.createElement(a.a.Fragment,null,r.current.map((function(t){return a.a.createElement("arrowHelper",{layers:u,ref:t,args:[new jt(0,0,0),e.object3d.position,10]})})))})),zt=Object(yt.a)((function(){var t=Object(c.useFacet)(l.a),e=Object(c.useFacet)(L),n=Object(o.useRef)();return t&&e?(n.current=t.object3d,a.a.createElement(_,{target:n,distance:.5,count:e.fitness})):null})),Mt=n(254),At=n.n(Mt),Ct=n(300),kt=n(232),Tt=n(192),It=function(){var t=Object(c.useQuery)((function(t){return t.hasAll(l.a,F)}));return Object(c.useSystem)((function(e){t.loop([l.a],(function(t,e){e[0].object3d.material.color.set("blue")}))}))},Rt=n(183),Pt=function(){var t=Object(c.useQuery)((function(t){return t.has(I)}));return Object(c.useSystem)((function(e){t.current.mloop([[I]],(function(t,e){e[0].forEach((function(t){if(t.intersections.length)for(var e,n=Object(Rt.a)(t.intersections);!(e=n()).done;){var r=e.value;if("food"===r.object.name){r.object.material.color.set("purple");break}}}))}))}))},Bt=function(t){var e=t.size,n=Object(o.useRef)();return a.a.createElement("group",null,a.a.createElement("directionalLight",{ref:n,position:[10,10,10],castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-camera-far":100,"shadow-camera-left":-100,"shadow-camera-right":100,"shadow-camera-top":100,"shadow-camera-bottom":-100}),a.a.createElement(Ct.a,{minDistance:30,maxPolarAngle:Object(c.rad)(60),minPolarAngle:Object(c.rad)(20)}),a.a.createElement(x.a,{scale:[2*e,1,2*e],position:[0,-1,0],receiveShadow:!0},a.a.createElement("meshPhongMaterial",{color:"white"})))},Ft=function(){var t=Object(c.useECS)();Object(c.useAnimationFrame)(t.update);var e=function(){return new w.Vector3(100*Math.random()*2-100,0,100*Math.random()*2-100)},n=new w.Layers;return n.enable(0),n.enable(1),a.a.createElement(Tt.a,{shadows:!0},a.a.createElement(kt.a,{makeDefault:!0,layers:n}),a.a.createElement(Bt,{size:100}),a.a.createElement(t.Provider,null,a.a.createElement(g,{size:100},At.a.times(600,(function(t){return a.a.createElement(c.Entity,{key:t},a.a.createElement(m,null),a.a.createElement(F,null),a.a.createElement(l.a,null,a.a.createElement(x.b,{name:"food",position:e()},a.a.createElement("meshPhongMaterial",{color:"blue"}))))})),a.a.createElement(It,null),a.a.createElement(Vt,null),a.a.createElement(Gt,null),a.a.createElement(B,{populationSize:30,feedForwardOnly:!1,fitnessThreshold:45,survivalThreshold:.95,ageSignificance:0,dropoffAge:999,addConnectionTries:20,adjustCompatibilityThreshold:!1,compatibilityModifier:.3,compatibilityModifierTarget:10,compatibilityThreshold:3,interspeciesMateRate:.001,disjointCoefficient:1,excessCoefficient:1,weightDifferenceCoefficient:1,genomeWeightPerturbated:.9,mutateAddConnectionProbability:.05,mutateAddNodeProbability:.03,mutateConnectionWeightsProbability:1,mutateOnlyProbability:.5,mutateToggleEnableProbability:0,mutationPower:.05,reEnableGeneProbability:.05,inputs:[new ct(C.Input,"hitDistance0"),new ct(C.Input,"hitGood0"),new ct(C.Input,"hitBad0"),new ct(C.Input,"hitDistance1"),new ct(C.Input,"hitGood1"),new ct(C.Input,"hitBad1"),new ct(C.Input,"hitDistance2"),new ct(C.Input,"hitGood2"),new ct(C.Input,"hitBad2"),new ct(C.Input,"hitDistance3"),new ct(C.Input,"hitGood3"),new ct(C.Input,"hitBad3"),new ct(C.Input,"hitDistance4"),new ct(C.Input,"hitGood4"),new ct(C.Input,"hitBad4"),new ct(C.Input,"hitDistance5"),new ct(C.Input,"hitGood5"),new ct(C.Input,"hitBad5"),new ct(C.Input,"hitDistance6"),new ct(C.Input,"hitGood6"),new ct(C.Input,"hitBad6")],outputs:[new ct(C.Output,"turnAmount"),new ct(C.Output,"thrustAmount")]},a.a.createElement(Lt,{ticks:250}),(function(t,n){return a.a.createElement(R,{key:Math.random(),organism:t,rotation:[0,Math.random()*Math.PI,0],position:e()})})),a.a.createElement(Qt,{multiplier:3}),a.a.createElement(Wt,{multiplier:60}),a.a.createElement(Nt,null),a.a.createElement(Ut,null),a.a.createElement(T.c,{size:100}),a.a.createElement(Dt,null),a.a.createElement(Pt,null))))},Nt=function(){var t=Object(c.useEngine)(),e=Object(c.useQuery)((function(t){return t.hasAll(l.a,L)})),n=b(),r=Object(o.useMemo)((function(){return new v.Circle(0,0,0)}),[]);return Object(c.useSystem)((function(i){e.loop([l.a,L],(function(e,i){var o=i[0],a=i[1],u=o.object3d.position;r.x=u.x,r.y=u.y,r.r=3;n.findInShape(r).map((function(t){return t.data.get(l.a)})).filter((function(t){return void 0!==t&&null!==t.object3d&&"link"===t.object3d.name&&t.object3d.userData.parent&&t.object3d.userData.parent.id!==e.id})).forEach((function(n){o.object3d.position.distanceTo(n.object3d.position)<2&&(a.organism.fitness=0,t.removeEntity(e))}))}))}))},Lt=function(t){var e=t.ticks,n=Object(o.useRef)(0),r=Object(c.useQuery)((function(t){return t.has(L)})),i=Object(o.useContext)(P),a=i.inputs,u=i.outputs,s=i.epoch;return Object(c.useSystem)((function(t){var i=0;r.loop([L],(function(t,e,n){var r=e[0];i=Math.max(i,r.fitness);var o=a.map((function(t){return r.input[t.id]})),s=r.network.activate(o);u.forEach((function(t,e){r.output[t.id]=s[e].value}))})),n.current++,n.current>e&&(n.current=0,r.loop([L],(function(t,e){var n=e[0];return n.organism.fitness=i>0?n.fitness/i:0})),console.log("Max fitness: "+i),i=0,s())}))},Dt=function(){var t=Object(c.useQuery)((function(t){return t.hasAll(l.a,p)})),e=new jt,n=new jt;return Object(c.useSystem)((function(r){t.loop([l.a,p],(function(t,r){var i=r[0],o=r[1],a=i.object3d,u=o.target.current;a&&u&&(a.getWorldPosition(e),u.getWorldPosition(n),e.sub(n).normalize().multiplyScalar(o.distance).add(n),a.position.copy(e))}))}))},Vt=function(){Object(Tt.d)().scene;var t=Object(c.useQuery)((function(t){return t.hasAll(l.a,I)})),e=b(),n=new w.Raycaster;return n.layers.set(0),Object(c.useSystem)((function(r){t.current.mloop([l.a,[I]],(function(t,r,i){var o=r[0];r[1].forEach((function(t){var r=o.object3d,i=r.localToWorld(t.direction.clone()),a=i.clone().sub(r.position).normalize();n.set(r.position,a),n.near=0,n.far=t.length;var u=e.findInShape(new v.Circle(i.x,i.y,t.length)).map((function(t){return t.data.get(l.a)})).filter((function(t){return void 0!==t})).map((function(t){return t.object3d})).filter((function(t){return null!==t}));try{t.intersections=n.intersectObjects(u,!0)}catch(s){}}))}))}))},Ut=function(){var t=Object(c.useQuery)((function(t){return t.hasAll(l.a,L)})),e=b(),n=Object(o.useMemo)((function(){return new v.Circle(0,0,0)}),[]);return Object(c.useSystem)((function(r){t.loop([l.a,L],(function(t,r){var i=r[0],o=r[1],a=i.object3d.position;n.x=a.x,n.y=a.y,n.r=3,e.findInShape(n).map((function(t){return t.data.get(l.a)})).filter((function(t){return"food"===t.object3d.name})).forEach((function(t){i.object3d.position.distanceTo(t.object3d.position)<2&&(o.fitness+=1,t.object3d.position.set(200*Math.random()-100,0,200*Math.random()-100))}))}))}))},Gt=function(){var t=Object(c.useQuery)((function(t){return t.hasAll(N,L)}));return Object(c.useSystem)((function(e){t.current.mloop([[I],L],(function(t,e,n){for(var r,i=e[0],o=e[1],a=0,u=Object(Rt.a)(i);!(r=u()).done;){var s=r.value,c="hitGood"+a,l="hitBad"+a,f="hitDistance"+a;if(s.intersections.length)t:for(var h,d=Object(Rt.a)(s.intersections);!(h=d()).done;){var p=h.value;switch(p.object.name){case"eater":case"link":o.input[c]=0,o.input[l]=1,o.input[f]=p.distance/s.length;break t;case"food":o.input[c]=s.intersections.filter((function(t){return"food"===t.object.name})).length,o.input[l]=0,o.input[f]=p.distance/s.length;break t;default:o.input[c]=0,o.input[l]=0,o.input[f]=1}}else o.input[c]=0,o.input[l]=0,o.input[f]=1;a++}}))}))},Wt=function(t){var e=t.multiplier,n=Object(c.useQuery)((function(t){return t.hasAll(l.a,L,D)}));return Object(c.useSystem)((function(t){n.loop([l.a,L,D],(function(n,r){var i=r[0],o=r[1],a=r[2];if(void 0!==o.output.thrustAmount){var u=1-o.output.thrustAmount;i.object3d.translateZ(u*t*a.amount*e)}}))}))},Qt=function(t){var e=t.multiplier,n=Object(c.useQuery)((function(t){return t.hasAll(l.a,L,V)}));return Object(c.useSystem)((function(t){n.current.mloop([l.a,L,V],(function(n,r,i){var o=r[0],a=r[1];r[2];if(a.output.turnAmount){var u=2*a.output.turnAmount-1,s=o.object3d.rotation;s.y=s.y+u*t*e}}))}))},qt={sidebar_position:3,sidebar_label:"Eater Experiment",title:"Eater Experiment"},Ht={unversionedId:"three/EaterExample",id:"three/EaterExample",isDocsHomePage:!1,title:"Eater Experiment",description:"Each creature is driven by a random neural architecture.",source:"@site/examples/three/EaterExample.md",sourceDirName:"three",slug:"/three/EaterExample",permalink:"/examples/three/EaterExample",version:"current",sidebar_label:"Eater Experiment",sidebarPosition:3,frontMatter:{sidebar_position:3,sidebar_label:"Eater Experiment",title:"Eater Experiment"},sidebar:"mySidebar",previous:{title:"Boids",permalink:"/examples/three/BoidExample"}},Zt=[],$t={toc:Zt};function Xt(t){var e=t.components,n=Object(i.a)(t,["components"]);return Object(u.b)("wrapper",Object(r.a)({},$t,n,{components:e,mdxType:"MDXLayout"}),Object(u.b)("p",null,"Each creature is driven by a random neural architecture."),Object(u.b)("p",null,"The more food eaten, the higher the chance to mate."),Object(u.b)("p",null,"After 500 ticks, a new population is generated by genetically crossbreeding the neural architectures of the most successful."),Object(u.b)(s.a,{code:"import React, { useRef } from 'react';\n\nimport _ from 'lodash';\nimport { Layers, Vector3 } from 'three';\n\nimport { NodeGene, NodeType } from '@alenaksu/neatjs';\nimport {\n    Box,\n    OrbitControls,\n    PerspectiveCamera,\n    Sphere,\n} from '@react-three/drei';\nimport { Canvas } from '@react-three/fiber';\n\nimport { Teleporter } from '@react-ecs/boids';\nimport {\n    Entity,\n    rad,\n    useAnimationFrame,\n    useECS,\n} from '@react-ecs/core';\nimport {\n    CollisionSystem,\n    Eater,\n    Evolver,\n    EvolverSystem,\n    FollowingSystem,\n    RaycastingSystem,\n    Rewarding,\n    RewardSystem,\n    SensingSystem,\n    ThrustingSystem,\n    TurningSystem,\n} from '@react-ecs/neat'\nimport { ThreeView } from '@react-ecs/three';\n\nimport { Indexed, Quadtree } from '../hooks/useQuadtree';\nimport { MeshResetSystem } from '../systems/MeshResetSystem';\nimport { SeenSystem } from '../systems/SeenSystem';\n\n\nconst Scenery = ({ size }) => {\n    const lightRef = useRef()\n    // useHelper(lightRef, DirectionalLightHelper, 'royalblue', 1)\n    // useHelper(lightRef, DirectionalLightShadow,)\n    return (\n        <group>\n            <directionalLight\n                ref={lightRef}\n                position={[10, 10, 10]}\n                castShadow\n                shadow-mapSize-width={2048}\n                shadow-mapSize-height={2048}\n                shadow-camera-far={100}\n                shadow-camera-left={-100}\n                shadow-camera-right={100}\n                shadow-camera-top={100}\n                shadow-camera-bottom={-100}\n            />\n            <OrbitControls\n                minDistance={30}\n                maxPolarAngle={rad(60)}\n                minPolarAngle={rad(20)} />\n\n            <Box scale={[size * 2, 1, size * 2]} position={[0, -1, 0]} receiveShadow>\n                <meshPhongMaterial color='white' />\n            </Box>\n        </group>\n    );\n}\n\nexport const BasicEaterScene = () => {\n    const ECS = useECS()\n    useAnimationFrame(ECS.update)\n\n    const size = 100;\n\n    const randomPosition = () => {\n        return new Vector3(Math.random() * size * 2 - size, 0, Math.random() * size * 2 - size);\n    }\n\n    // enable camera for sim and debug layers\n    const layers = new Layers();\n    layers.enable(0)\n    layers.enable(1)\n\n\n    return (\n        <Canvas shadows>\n            <PerspectiveCamera makeDefault layers={layers} />\n            <Scenery size={size} />\n            <ECS.Provider>\n                <Quadtree size={size}>\n\n                    {/* generate food on the board */}\n                    {_.times(600, (i) => (\n                        <Entity key={i}>\n                            <Indexed />\n                            <Rewarding />\n                            <ThreeView>\n                                <Sphere name=\"food\" position={randomPosition()}>\n                                    <meshPhongMaterial color='blue' />\n                                </Sphere>\n                            </ThreeView>\n                        </Entity>\n                    ))}\n\n                    {/* systems to run before network activation */}\n                    <MeshResetSystem />\n                    <RaycastingSystem />\n                    {/* <SmellingSystem /> */}\n                    <SensingSystem />\n\n\n                    {/* evolver for the creatures */}\n                    <Evolver\n                        populationSize={30}\n                        feedForwardOnly={false}\n                        fitnessThreshold={45}\n                        survivalThreshold={0.95}\n\n                        ageSignificance={0}\n                        dropoffAge={999}\n\n                        addConnectionTries={20}\n\n                        adjustCompatibilityThreshold={false}\n                        compatibilityModifier={0.3}\n                        compatibilityModifierTarget={10}\n                        compatibilityThreshold={3.0}\n                        interspeciesMateRate={0.001}\n\n                        disjointCoefficient={1.0}\n                        excessCoefficient={1.0}\n                        weightDifferenceCoefficient={1}\n\n                        genomeWeightPerturbated={0.9}\n                        mutateAddConnectionProbability={0.05}\n                        mutateAddNodeProbability={0.03}\n                        mutateConnectionWeightsProbability={1}\n                        mutateOnlyProbability={.5}\n                        mutateToggleEnableProbability={0}\n                        mutationPower={.05}\n                        reEnableGeneProbability={0.05}\n\n                        inputs={[\n                            new NodeGene(NodeType.Input, 'hitDistance0'),\n                            new NodeGene(NodeType.Input, 'hitGood0'),\n                            new NodeGene(NodeType.Input, 'hitBad0'),\n\n                            new NodeGene(NodeType.Input, 'hitDistance1'),\n                            new NodeGene(NodeType.Input, 'hitGood1'),\n                            new NodeGene(NodeType.Input, 'hitBad1'),\n\n                            new NodeGene(NodeType.Input, 'hitDistance2'),\n                            new NodeGene(NodeType.Input, 'hitGood2'),\n                            new NodeGene(NodeType.Input, 'hitBad2'),\n\n                            new NodeGene(NodeType.Input, 'hitDistance3'),\n                            new NodeGene(NodeType.Input, 'hitGood3'),\n                            new NodeGene(NodeType.Input, 'hitBad3'),\n\n                            new NodeGene(NodeType.Input, 'hitDistance4'),\n                            new NodeGene(NodeType.Input, 'hitGood4'),\n                            new NodeGene(NodeType.Input, 'hitBad4'),\n\n                            new NodeGene(NodeType.Input, 'hitDistance5'),\n                            new NodeGene(NodeType.Input, 'hitGood5'),\n                            new NodeGene(NodeType.Input, 'hitBad5'),\n\n                            new NodeGene(NodeType.Input, 'hitDistance6'),\n                            new NodeGene(NodeType.Input, 'hitGood6'),\n                            new NodeGene(NodeType.Input, 'hitBad6'),\n\n\n                        ]}\n                        outputs={[\n                            new NodeGene(NodeType.Output, 'turnAmount'),\n                            new NodeGene(NodeType.Output, 'thrustAmount'),\n                        ]}>\n\n                        <EvolverSystem ticks={250}  />\n\n\n                        {(o, i) => {\n                            return <Eater\n                                key={Math.random()}\n                                organism={o}\n                                rotation={[0, Math.random() * Math.PI, 0]}\n                                position={randomPosition()} />\n                        }}\n                    </Evolver>\n\n                    {/* systems to run after network activation */}\n                    <TurningSystem multiplier={3} />\n                    <ThrustingSystem multiplier={60} />\n                    <CollisionSystem />\n                    <RewardSystem />\n                    <Teleporter size={size} />\n                    <FollowingSystem />\n                    <SeenSystem />\n                </Quadtree>\n            </ECS.Provider>\n        </Canvas>\n    )\n}\n",style:{minHeight:"400px",padding:"1em"},mdxType:"Example"},Object(u.b)(Ft,{mdxType:"BasicEaterScene"})))}Xt.isMDXComponent=!0},162:function(t,e,n){"use strict";var r=n(181);n.d(e,"DOMView",(function(){return r.a})),n.d(e,"ECSContext",(function(){return r.b})),n.d(e,"Emitter",(function(){return r.c})),n.d(e,"Entity",(function(){return r.d})),n.d(e,"Facet",(function(){return r.e}));var i=n(173);n.d(e,"EntityContext",(function(){return i.a})),n.d(e,"useAnimationFrame",(function(){return i.b})),n.d(e,"useECS",(function(){return i.c})),n.d(e,"useEngine",(function(){return i.d})),n.d(e,"useEntity",(function(){return i.e})),n.d(e,"useFacet",(function(){return i.f})),n.d(e,"useQuery",(function(){return i.g})),n.d(e,"useStatefulRef",(function(){return i.h})),n.d(e,"useSystem",(function(){return i.i}));var o=n(178);n.o(o,"rad")&&n.d(e,"rad",(function(){return o.rad}))},164:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return c}));var r=n(163),i=n(0),o=n.n(i),a=n(176),u=n(168),s=Object(i.createContext)(null),c=function(){function t(t,e){var n=this;void 0===t&&(t=[]),void 0===e&&(e=[]),Object(r.a)(this,"engine",new a.Engine),Object(r.a)(this,"systems",new u.a),this.update=this.update.bind(this),this.Provider=this.Provider.bind(this),t.forEach((function(t){return n.systems.add(t)})),e.forEach((function(t){return n.engine.addEntity(t)}))}var e=t.prototype;return e.update=function(t){this.systems.update(t)},e.Provider=function(t){return o.a.createElement(s.Provider,{value:this},t.children)},t}()},165:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n(0),i=Object(r.createContext)(null);function o(){var t=Object(r.useContext)(i);if(!t)throw new Error("Missing Entity instance in EntityContext!");return t}},167:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n(164),o=function(){return Object(r.useContext)(i.b).engine}},168:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(163),i=function(){function t(){Object(r.a)(this,"systems",void 0),this.systems=new Array}var e=t.prototype;return e.sort=function(){this.systems.sort((function(t,e){return t.priority-e.priority}))},e.add=function(t,e){void 0===e&&(e=0),this.systems.push({callback:t,priority:e}),this.sort()},e.remove=function(t){var e=this.systems.findIndex((function(e){return e.callback===t}));return e>-1&&(this.systems.splice(e,1),this.sort(),!0)},e.clear=function(){this.systems=[]},e.update=function(t){this.systems.forEach((function(e){return e.callback(t)}))},t}()},169:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(183),i=n(4),o=n(176),a=function(t){function e(){return t.apply(this,arguments)||this}Object(i.a)(e,t);var n=e.prototype;return n.loop=function(t,e){for(var n=0;n<this.entities.length;n++){for(var i,o=this.entities[n],a=[],u=Object(r.a)(t);!(i=u()).done;){var s=i.value,c=o.get(s);a.push(c)}e(o,a,n)}},n.rloop=function(t,e){for(var n=this.entities.length-1;n>=0;n--){for(var i,o=this.entities[n],a=[],u=Object(r.a)(t);!(i=u()).done;){var s=i.value,c=o.get(s);a.push(c)}e(o,a,n)}},n.mloop=function(t,e){for(var n=0;n<this.entities.length;n++){for(var i,o=this.entities[n],a=[],u=Object(r.a)(t);!(i=u()).done;){var s=i.value;if(1===s.length&&void 0!==s[0]){for(var c=o.get(s[0]),l=[c];c.next;)l.push(c.next),c=c.next;a.push(l)}else{var f=o.get(s);a.push(f)}}e(o,a,n)}},e}(o.Query)},170:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(0);function i(t){var e=Object(r.useRef)(t),n=Object(r.useState)({current:t}),i=(n[0],n[1]);return[e,function(t){e.current=t,i({current:t})}]}},171:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n(164),o=function(t,e){void 0===e&&(e=0);var n=Object(r.useContext)(i.b).systems;return Object(r.useEffect)((function(){return n.add(t,e),function(){n.remove(t)}}),[t,e]),null}},172:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(0),i=n(171),o=function(t,e){var n=Object(r.useRef)(0);Object(i.a)((function(r){n.current+=r,n.current>t&&(n.current=0,e())}))}},173:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return u.a})),n.d(e,"a",(function(){return s.a})),n.d(e,"e",(function(){return s.b})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return p})),n.d(e,"h",(function(){return v.a})),n.d(e,"i",(function(){return m.a}));var r=n(0),i=function(t){var e=Object(r.useRef)(null),n=Object(r.useRef)(null),i=function r(i){if(void 0!==n.current){var o=i-n.current;t(o/1e3)}n.current=i,e.current=requestAnimationFrame(r)};Object(r.useEffect)((function(){return e.current=requestAnimationFrame(i),function(){return cancelAnimationFrame(e.current)}}),[])},o=n(164);function a(){var t=Object(r.useState)((function(){return new o.a}))[0];return Object(r.useEffect)((function(){"undefined"!=typeof window&&(window.ecs=t)})),t}var u=n(167),s=n(165);function c(t){var e=Object(s.b)(),n=Object(r.useState)(new t),i=n[0],o=n[1];return Object(r.useEffect)((function(){var n=e.get(t);n?o(n):(o(void 0),console.warn("Couldn't find facet on entity: "+t.prototype.constructor.name))})),i}var l=n(169),f=n(182),h=n(163),d=function(){function t(t){Object(h.a)(this,"ref",void 0),this.ref=t}var e=t.prototype;return e.loop=function(t,e){if(this.current)return this.current.loop(t,e)},e.rloop=function(t,e){if(this.current)return this.current.rloop(t,e)},e.countBy=function(t){return this.current?this.current.countBy(t):0},e.filter=function(t){return this.current?this.current.filter(t):[]},e.has=function(t){return!!this.current&&this.current.has(t)},e.clear=function(){if(this.current)return this.current.clear()},Object(f.a)(t,[{key:"current",get:function(){return this.ref.current}},{key:"entities",get:function(){if(this.current)return this.current.entities}},{key:"first",get:function(){if(this.current)return this.current.first}},{key:"last",get:function(){if(this.current)return this.current.last}},{key:"length",get:function(){if(this.current)return this.current.length}},{key:"isEmpty",get:function(){return!this.current||this.current.isEmpty}}]),t}();function p(t,e){var n=Object(u.a)(),i=Object(r.useRef)(),o=Object(r.useState)(0),a=o[0],s=o[1],c=function(){return s(a+1)};return Object(r.useEffect)((function(){if(void 0===i.current){var r=new l.a(t);null!=e&&e.added&&r.onEntityAdded.connect(e.added),null!=e&&e.removed&&r.onEntityRemoved.connect(e.removed),r.onEntityAdded.connect(c),r.onEntityRemoved.connect(c),n.addQuery(r),i.current=r,c()}}),[]),new d(i)}var v=n(170),m=n(171);n(172)},174:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n(182),i=n(166),o=n(4),a=n(163),u=n(0),s=n.n(u),c=n(162),l=function(t){function e(e){var n;return n=t.call(this,e)||this,Object(a.a)(Object(i.a)(n),"context",void 0),Object(a.a)(Object(i.a)(n),"ref",void 0),n.ref=Object(u.createRef)(),n}Object(o.a)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this.context;t.add(this);var e=this.ref.current.userData||{};e.entity=t,this.ref.current.userData=e},n.componentWillUnmount=function(){this.context.removeComponent(e)},n.render=function(){if(1!==u.Children.count(this.props.children))throw new Error("<ThreeView /> must have a single child.");return s.a.createElement(s.a.Fragment,null,s.a.cloneElement(this.props.children,{ref:this.ref}))},Object(r.a)(e,[{key:"object3d",get:function(){return this.ref.current}}]),e}(u.Component);Object(a.a)(l,"contextType",c.EntityContext),l.__componentClassId__=100},178:function(t,e,n){"use strict";n(169);var r=n(179);n.o(r,"rad")&&n.d(e,"rad",(function(){return r.rad}));n(168);var i=n(180);n.d(e,"rad",(function(){return i.a}))},179:function(t,e){},180:function(t,e,n){"use strict";function r(t){return t*Math.PI/180}n.d(e,"a",(function(){return r}))},181:function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return f.b})),n.d(e,"c",(function(){return m})),n.d(e,"d",(function(){return _})),n.d(e,"e",(function(){return j}));var r=n(182),i=n(166),o=n(4),a=n(163),u=n(0),s=n.n(u),c=n(173),l=function(t){function e(e){var n;return n=t.call(this,e)||this,Object(a.a)(Object(i.a)(n),"context",void 0),Object(a.a)(Object(i.a)(n),"ref",void 0),n.ref=Object(u.createRef)(),n}Object(o.a)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.context.add(this)},n.render=function(){if(1!==u.Children.count(this.props.children))throw new Error("<DOMView /> must have a single child.");return s.a.createElement(s.a.Fragment,null,Object(u.cloneElement)(this.props.children,{ref:this.ref}))},Object(r.a)(e,[{key:"element",get:function(){return this.ref.current}}]),e}(u.Component);Object(a.a)(l,"contextType",c.a),l.__componentClassId__=-1;var f=n(164),h=n(167),d=n(170),p=n(172),v={emissionDelay:.1},m=function(t){var e=Object(h.a)(),n=(t=Object.assign({},v,t)).emissionDelay,r=Object(u.useRef)(0),i=t.children,o=Object(d.a)([]),a=o[0],c=o[1];Object(p.a)(n,(function(){var t,e;c([(t=Object(u.createRef)(),e=r.current++,{element:Object.assign({},i(t),{key:e}),ref:t})].concat(a.current))}));var l=function(t){a.current.forEach((function(e,n){null!=e.ref.current&&e.ref.current.id!==t.id||function(t){if(t>-1)if(1===a.current.length)c([]);else{var e=a.current.slice(0,t),n=a.current.slice(t+1);c(e.concat(n))}}(n)}))};return Object(u.useEffect)((function(){return e.onEntityRemoved.connect(l),function(){e.onEntityRemoved.disconnect(l)}}),[]),s.a.createElement(s.a.Fragment,null,a.current.map((function(t){return t.element})))},y=n(176),g=n(165),b=n(162),_=function(t){var e=Object(u.useContext)(f.b),n=Object(b.useStatefulRef)(void 0),r=n[0],i=n[1],o=Object(u.useCallback)((function(e){r.current&&e.id===r.current.id&&(t.entityRef&&(t.entityRef.current=null),r.current.clear(),r.current.invalidate(),i(null))}),[r.current]);return Object(u.useEffect)((function(){if(void 0===r.current){var n=t.entity||new y.Entity;e.engine.addEntity(n),e.engine.onEntityRemoved.connect(o),i(n)}return function(){e.engine.onEntityRemoved.disconnect(o),r.current&&(r.current.clear(),r.current.invalidate(),e.engine.removeEntity(r.current))}}),[]),r.current?s.a.createElement(g.a.Provider,{value:r.current},t.children):null},w=n(196);Object(w.a)({enforceActions:"never"});var x=["props","context","refs","updater","meta"],j=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return e=t.call.apply(t,[this].concat(r))||this,Object(a.a)(Object(i.a)(e),"context",void 0),e}Object(o.a)(e,t);var n=e.prototype;return n.asComponent=function(){return this},n.createFake=function(){return new(0,Object.getPrototypeOf(this).constructor)},n.getAnnotations=function(t){var e=new Map(Object.getOwnPropertyNames(t).filter((function(t){return!x.includes(t)&&!t.endsWith("Ref")})).map((function(t){return[t,w.c]}))).entries();return Object.fromEntries(e)},n.componentDidMount=function(){if(this.context){Object.assign(this,this.props);var t=this.createFake(),e=this.getAnnotations(t);Object(w.b)(this,e,{autoBind:!0}),this.context.append(this)}else console.error("Data Component without Entity Context!")},n.render=function(){return Object.assign(this,this.props),null},e}(u.Component);Object(a.a)(j,"contextType",g.a)},186:function(t,e,n){t.exports={example:"example_1hIu",leva:"leva_2JxF"}},188:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(191),i=n(187),o=n(0),a=n.n(o),u=n(3),s=n(185),c=function(t){return a.a.createElement(s.a,Object(u.a)({},s.b,{code:t.code,language:"tsx"}),(function(t){var e=t.className,n=t.style,r=t.tokens,i=t.getLineProps,o=t.getTokenProps;return a.a.createElement("pre",{className:e,style:n},r.map((function(t,e){return a.a.createElement("div",i({line:t,key:e}),t.map((function(t,e){return a.a.createElement("span",o({token:t,key:e}))})))})))}))},l=n(186),f=n.n(l),h=function(t){return a.a.createElement("div",{style:{flex:1,display:"flex",alignItems:"stretch",flexDirection:"column"}},a.a.createElement("div",{className:f.a.leva,style:{top:"75px",display:t.hideControls?"none":"block"}},a.a.createElement(i.a,{fill:!0,collapsed:t.collapsed})),a.a.createElement("div",{className:f.a.example,style:Object.assign({marginBottom:"1em",position:"relative",overflow:"hidden",padding:"1em"},t.style||{})},a.a.createElement(r.a,{fallback:a.a.createElement("div",null)},(function(){return a.a.createElement(o.Suspense,{fallback:a.a.createElement("div",null)},t.children)}))),t.code&&a.a.createElement(c,{code:t.code}))}},203:function(t,e,n){"use strict";n.d(e,"a",(function(){return E})),n.d(e,"b",(function(){return M})),n.d(e,"c",(function(){return y})),n.d(e,"d",(function(){return v}));var r=n(299),i=n(187),o=n(0),a=n.n(o),u=n(166),s=n(4),c=n(163),l=n(162),f=n(177),h=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r))||this,Object(c.a)(Object(u.a)(e),"amount",new f.Vector3(0,0,0)),e}return Object(s.a)(e,t),e}(l.Facet),d=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r))||this,Object(c.a)(Object(u.a)(e),"meta",{neighbors:[]}),e}return Object(s.a)(e,t),e}(l.Facet),p=n(174),v=function(t){function e(){return t.apply(this,arguments)||this}return Object(s.a)(e,t),e}(l.Facet),m=function(t){var e=Object(l.useQuery)((function(t){return t.hasAll(p.a,v)}));return Object(l.useSystem)((function(n){e.loop([p.a],(function(e,n){var r=n[0].object3d.position;r.x<-t.size?r.setX(t.size):r.x>t.size&&r.setX(-t.size),r.y<-t.size?r.setY(t.size):r.y>t.size&&r.setY(-t.size),r.z<-t.size?r.setZ(t.size):r.z>t.size&&r.setZ(-t.size)}))}))},y=function(t){return a.a.createElement(a.a.Fragment,null,a.a.createElement(m,{size:t.size}),t.showBounds&&a.a.createElement(a.a.Fragment,null,a.a.createElement(r.a,{scale:3}),a.a.createElement(r.a,{position:[t.size,t.size,t.size]}),a.a.createElement(r.a,{position:[-t.size,-t.size,-t.size]}),a.a.createElement(r.a,{position:[t.size,-t.size,t.size]}),a.a.createElement(r.a,{position:[-t.size,t.size,-t.size]}),a.a.createElement(r.a,{position:[t.size,t.size,-t.size]}),a.a.createElement(r.a,{position:[-t.size,-t.size,t.size]}),a.a.createElement(r.a,{position:[t.size,-t.size,-t.size]}),a.a.createElement(r.a,{position:[-t.size,t.size,t.size]})))};(function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r))||this,Object(c.a)(Object(u.a)(e),"targetView",void 0),Object(c.a)(Object(u.a)(e),"pointerRef",void 0),e}return Object(s.a)(e,t),e}(l.Facet)).__componentClassId__=99;var g=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e=t.call.apply(t,[this].concat(r))||this,Object(c.a)(Object(u.a)(e),"amount",new f.Vector3(Math.random()-.5,Math.random()-.5,Math.random()-.5)),e}return Object(s.a)(e,t),e}(l.Facet),b=n(183),_=function(t){var e=Object(l.useQuery)((function(t){return t.hasAll(d,g,h)}));return Object(l.useSystem)((function(n){e.loop([d,g,h],(function(e,n){for(var r,i=n[0],o=n[1],a=n[2],u=new f.Vector3(0,0,0),s=i.meta.neighbors,c=Object(b.a)(i.meta.neighbors);!(r=c()).done;){var l=r.value.get(g).amount;u.add(l)}s.length&&(u.divideScalar(s.length),u.sub(o.amount),u.clampLength(t.min||0,t.max||1)),a.amount=u.normalize().clone().multiplyScalar(t.amount)}))}))},w=function(t){var e=Object(l.useQuery)((function(t){return t.hasAll(p.a,g,d)}));return Object(l.useSystem)((function(n){e.loop([p.a,d,g,h],(function(e,n){for(var r,i=n[0],o=n[1],a=n[2],u=n[3],s=i.object3d,c=new f.Vector3,l=o.meta.neighbors,h=Object(b.a)(l);!(r=h()).done;){var d=r.value;c.add(d.get(p.a).object3d.position)}l.length&&(c.divideScalar(l.length),c.sub(s.position),c.setLength(1),c.sub(a.amount),c.clampLength(t.min,t.max),c.multiplyScalar(t.amount)),u.amount.add(c)}))}))},x=function(t){var e=Object(l.useQuery)((function(t){return t.hasAll(p.a,g,h)}));return Object(l.useSystem)((function(n){null==e||e.loop([p.a,g,h],(function(e,r){var i=r[0],o=r[1],a=r[2],u=i.object3d;if(o.amount.length()>0){var s=u.position.clone().add(o.amount);u.lookAt(s)}var c=u.position.clone().add(o.amount.clone().multiplyScalar(n));o.amount.add(a.amount),o.amount.clampLength(t.min,t.max),u.position.copy(c)}))}))},j=(l.Facet,new f.LineBasicMaterial({color:new f.Color(Math.random(),Math.random(),Math.random())}),new f.Vector3,function(t){var e=Object(l.useQuery)((function(t){return t.hasAll(p.a,d)}));return Object(l.useSystem)((function(n){e.loop([p.a,d],(function(n,r){var i=r[0],o=r[1],a=i.object3d,u=function(t){return a.position.distanceTo(function(t){return t.get(p.a).object3d}(t).position)};o.meta.neighbors=e.entities.filter((function(t){return t.id!==n.id})).filter((function(e){return!t.filter||t.filter(n,e)})).filter((function(e){return u(e)<t.radius})).sort((function(t,e){return u(t)-u(e)}))}))}))}),O=function(t){var e=Object(l.useQuery)((function(t){return t.hasAll(p.a,g,d)}));return Object(l.useSystem)((function(n){e.loop([p.a,d,g,h],(function(e,n){for(var r,i=n[0],o=n[1],a=n[2],u=n[3],s=i.object3d,c=new f.Vector3,l=o.meta.neighbors,h=Object(b.a)(l);!(r=h()).done;){var d=r.value.get(p.a).object3d.position,v=s.position.distanceTo(d),m=s.position.clone().sub(d);m.divideScalar(v*v),c.add(m)}l.length&&(c.divideScalar(l.length),c.sub(a.amount),c.clampLength(t.min,t.max),c.multiplyScalar(t.amount)),u.amount.add(c)}))}))},E=function(t){var e=Object(i.b)("sim",{size:{value:100,min:20,max:200},count:{value:250,min:1,max:250},spawnHeight:{value:1,min:0,max:1},neighborRadius:{value:10,min:1,max:50},showBounds:!1},{}),n=e.size,u=e.count,s=e.spawnHeight,c=e.neighborRadius,l=e.showBounds,f=Object(i.b)("alignment",{enabled:!0,multiplier:{value:.1,min:0,max:1},turningRange:{value:[0,.1],min:0,max:1}}),h=Object(i.b)("cohesion",{enabled:!0,multiplier:{value:1,min:0,max:1},speedRange:{value:[0,1],min:0,max:10}}),d=Object(i.b)("separation",{enabled:!0,multiplier:{value:2,min:0,max:2},speedRange:{value:[0,3],min:0,max:10}}),p=Object(i.b)("speed",{range:{value:[15,50],min:0,max:50}}),v=function(){return Math.random()*n*2-n},m=Object(o.useMemo)((function(){for(var e=[],n=0;n<u;n++)e.push(a.a.createElement(o.Suspense,{fallback:a.a.createElement(r.c,null)},a.a.createElement(M,{render:t.render,position:[v(),v()*s,v()]})));return e}),[n,s,u]);return a.a.createElement(a.a.Fragment,null,a.a.createElement(y,{showBounds:l,size:n}),a.a.createElement(j,{radius:c}),a.a.createElement(_,{amount:f.enabled?f.multiplier:0,min:f.turningRange[0],max:f.turningRange[1]}),a.a.createElement(w,{amount:h.enabled?h.multiplier:0,min:h.speedRange[0],max:h.speedRange[1]}),a.a.createElement(O,{amount:d.enabled?d.multiplier:0,min:d.speedRange[0],max:d.speedRange[1]}),a.a.createElement(x,{min:p.range[0],max:p.range[1]}),m)},S=n(3),z=n(7),M=Object(o.forwardRef)((function(t,e){var n=t.render,r=Object(z.a)(t,["render"]);return a.a.createElement(l.Entity,null,a.a.createElement(d,null),a.a.createElement(g,null),a.a.createElement(h,null),a.a.createElement(v,null),a.a.createElement(p.a,null,a.a.createElement("group",Object(S.a)({ref:e},r,{dispose:null}),n())))}))},230:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(261);e.Point=r.Point;var i=n(292);e.Box=i.Box;var o=n(293);e.Circle=o.Circle;var a=n(262);e.Element=a.Element;var u=n(294);e.Quadtree=u.Quadtree},232:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(3),i=n(7),o=n(0),a=n(192);var u=function(t){return function(e){t.forEach((function(t){"function"==typeof t?t(e):null!=t&&(t.current=e)}))}};const s=Object(o.forwardRef)((t,e)=>{let{makeDefault:n=!1}=t,s=Object(i.a)(t,["makeDefault"]);const c=Object(a.d)(({set:t})=>t),l=Object(a.d)(({camera:t})=>t),f=Object(a.d)(({size:t})=>t),h=Object(o.useRef)();return Object(o.useLayoutEffect)(()=>{const{current:t}=h;t&&(t.aspect=f.width/f.height,t.updateProjectionMatrix())},[f,s]),Object(o.useLayoutEffect)(()=>{if(n&&h.current){const t=l;return c(()=>({camera:h.current})),()=>c(()=>({camera:t}))}},[l,h,n,c]),Object(o.createElement)("perspectiveCamera",Object(r.a)({ref:u([h,e])},s))})},254:function(t,e,n){(function(t,r){var i;(function(){var o="Expected a function",a="__lodash_placeholder__",u=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],s="[object Arguments]",c="[object Array]",l="[object Boolean]",f="[object Date]",h="[object Error]",d="[object Function]",p="[object GeneratorFunction]",v="[object Map]",m="[object Number]",y="[object Object]",g="[object RegExp]",b="[object Set]",_="[object String]",w="[object Symbol]",x="[object WeakMap]",j="[object ArrayBuffer]",O="[object DataView]",E="[object Float32Array]",S="[object Float64Array]",z="[object Int8Array]",M="[object Int16Array]",A="[object Int32Array]",C="[object Uint8Array]",k="[object Uint16Array]",T="[object Uint32Array]",I=/\b__p \+= '';/g,R=/\b(__p \+=) '' \+/g,P=/(__e\(.*?\)|\b__t\)) \+\n'';/g,B=/&(?:amp|lt|gt|quot|#39);/g,F=/[&<>"']/g,N=RegExp(B.source),L=RegExp(F.source),D=/<%-([\s\S]+?)%>/g,V=/<%([\s\S]+?)%>/g,U=/<%=([\s\S]+?)%>/g,G=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,W=/^\w*$/,Q=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,q=/[\\^$.*+?()[\]{}|]/g,H=RegExp(q.source),Z=/^\s+/,$=/\s/,X=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Y=/\{\n\/\* \[wrapped with (.+)\] \*/,J=/,? & /,K=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,tt=/[()=,{}\[\]\/\s]/,et=/\\(\\)?/g,nt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,rt=/\w*$/,it=/^[-+]0x[0-9a-f]+$/i,ot=/^0b[01]+$/i,at=/^\[object .+?Constructor\]$/,ut=/^0o[0-7]+$/i,st=/^(?:0|[1-9]\d*)$/,ct=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,lt=/($^)/,ft=/['\n\r\u2028\u2029\\]/g,ht="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",dt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pt="[\\ud800-\\udfff]",vt="["+dt+"]",mt="["+ht+"]",yt="\\d+",gt="[\\u2700-\\u27bf]",bt="[a-z\\xdf-\\xf6\\xf8-\\xff]",_t="[^\\ud800-\\udfff"+dt+yt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",wt="\\ud83c[\\udffb-\\udfff]",xt="[^\\ud800-\\udfff]",jt="(?:\\ud83c[\\udde6-\\uddff]){2}",Ot="[\\ud800-\\udbff][\\udc00-\\udfff]",Et="[A-Z\\xc0-\\xd6\\xd8-\\xde]",St="(?:"+bt+"|"+_t+")",zt="(?:"+Et+"|"+_t+")",Mt="(?:"+mt+"|"+wt+")"+"?",At="[\\ufe0e\\ufe0f]?"+Mt+("(?:\\u200d(?:"+[xt,jt,Ot].join("|")+")[\\ufe0e\\ufe0f]?"+Mt+")*"),Ct="(?:"+[gt,jt,Ot].join("|")+")"+At,kt="(?:"+[xt+mt+"?",mt,jt,Ot,pt].join("|")+")",Tt=RegExp("['\u2019]","g"),It=RegExp(mt,"g"),Rt=RegExp(wt+"(?="+wt+")|"+kt+At,"g"),Pt=RegExp([Et+"?"+bt+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?="+[vt,Et,"$"].join("|")+")",zt+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?="+[vt,Et+St,"$"].join("|")+")",Et+"?"+St+"+(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Et+"+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",yt,Ct].join("|"),"g"),Bt=RegExp("[\\u200d\\ud800-\\udfff"+ht+"\\ufe0e\\ufe0f]"),Ft=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Nt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Lt=-1,Dt={};Dt[E]=Dt[S]=Dt[z]=Dt[M]=Dt[A]=Dt[C]=Dt["[object Uint8ClampedArray]"]=Dt[k]=Dt[T]=!0,Dt[s]=Dt[c]=Dt[j]=Dt[l]=Dt[O]=Dt[f]=Dt[h]=Dt[d]=Dt[v]=Dt[m]=Dt[y]=Dt[g]=Dt[b]=Dt[_]=Dt[x]=!1;var Vt={};Vt[s]=Vt[c]=Vt[j]=Vt[O]=Vt[l]=Vt[f]=Vt[E]=Vt[S]=Vt[z]=Vt[M]=Vt[A]=Vt[v]=Vt[m]=Vt[y]=Vt[g]=Vt[b]=Vt[_]=Vt[w]=Vt[C]=Vt["[object Uint8ClampedArray]"]=Vt[k]=Vt[T]=!0,Vt[h]=Vt[d]=Vt[x]=!1;var Ut={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Gt=parseFloat,Wt=parseInt,Qt="object"==typeof t&&t&&t.Object===Object&&t,qt="object"==typeof self&&self&&self.Object===Object&&self,Ht=Qt||qt||Function("return this")(),Zt=e&&!e.nodeType&&e,$t=Zt&&"object"==typeof r&&r&&!r.nodeType&&r,Xt=$t&&$t.exports===Zt,Yt=Xt&&Qt.process,Jt=function(){try{var t=$t&&$t.require&&$t.require("util").types;return t||Yt&&Yt.binding&&Yt.binding("util")}catch(e){}}(),Kt=Jt&&Jt.isArrayBuffer,te=Jt&&Jt.isDate,ee=Jt&&Jt.isMap,ne=Jt&&Jt.isRegExp,re=Jt&&Jt.isSet,ie=Jt&&Jt.isTypedArray;function oe(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function ae(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var a=t[i];e(r,a,n(a),t)}return r}function ue(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function se(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function ce(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function le(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}function fe(t,e){return!!(null==t?0:t.length)&&we(t,e,0)>-1}function he(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function de(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function pe(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function ve(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function me(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function ye(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var ge=Ee("length");function be(t,e,n){var r;return n(t,(function(t,n,i){if(e(t,n,i))return r=n,!1})),r}function _e(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function we(t,e,n){return e==e?function(t,e,n){var r=n-1,i=t.length;for(;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):_e(t,je,n)}function xe(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function je(t){return t!=t}function Oe(t,e){var n=null==t?0:t.length;return n?Me(t,e)/n:NaN}function Ee(t){return function(e){return null==e?void 0:e[t]}}function Se(t){return function(e){return null==t?void 0:t[e]}}function ze(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n}function Me(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function Ae(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Ce(t){return t?t.slice(0,Ze(t)+1).replace(Z,""):t}function ke(t){return function(e){return t(e)}}function Te(t,e){return de(e,(function(e){return t[e]}))}function Ie(t,e){return t.has(e)}function Re(t,e){for(var n=-1,r=t.length;++n<r&&we(e,t[n],0)>-1;);return n}function Pe(t,e){for(var n=t.length;n--&&we(e,t[n],0)>-1;);return n}function Be(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}var Fe=Se({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"}),Ne=Se({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Le(t){return"\\"+Ut[t]}function De(t){return Bt.test(t)}function Ve(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function Ue(t,e){return function(n){return t(e(n))}}function Ge(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var u=t[n];u!==e&&u!==a||(t[n]=a,o[i++]=n)}return o}function We(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function Qe(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function qe(t){return De(t)?function(t){var e=Rt.lastIndex=0;for(;Rt.test(t);)++e;return e}(t):ge(t)}function He(t){return De(t)?function(t){return t.match(Rt)||[]}(t):function(t){return t.split("")}(t)}function Ze(t){for(var e=t.length;e--&&$.test(t.charAt(e)););return e}var $e=Se({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Xe=function t(e){var n,r=(e=null==e?Ht:Xe.defaults(Ht.Object(),e,Xe.pick(Ht,Nt))).Array,i=e.Date,$=e.Error,ht=e.Function,dt=e.Math,pt=e.Object,vt=e.RegExp,mt=e.String,yt=e.TypeError,gt=r.prototype,bt=ht.prototype,_t=pt.prototype,wt=e["__core-js_shared__"],xt=bt.toString,jt=_t.hasOwnProperty,Ot=0,Et=(n=/[^.]+$/.exec(wt&&wt.keys&&wt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",St=_t.toString,zt=xt.call(pt),Mt=Ht._,At=vt("^"+xt.call(jt).replace(q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ct=Xt?e.Buffer:void 0,kt=e.Symbol,Rt=e.Uint8Array,Bt=Ct?Ct.allocUnsafe:void 0,Ut=Ue(pt.getPrototypeOf,pt),Qt=pt.create,qt=_t.propertyIsEnumerable,Zt=gt.splice,$t=kt?kt.isConcatSpreadable:void 0,Yt=kt?kt.iterator:void 0,Jt=kt?kt.toStringTag:void 0,ge=function(){try{var t=to(pt,"defineProperty");return t({},"",{}),t}catch(e){}}(),Se=e.clearTimeout!==Ht.clearTimeout&&e.clearTimeout,Ye=i&&i.now!==Ht.Date.now&&i.now,Je=e.setTimeout!==Ht.setTimeout&&e.setTimeout,Ke=dt.ceil,tn=dt.floor,en=pt.getOwnPropertySymbols,nn=Ct?Ct.isBuffer:void 0,rn=e.isFinite,on=gt.join,an=Ue(pt.keys,pt),un=dt.max,sn=dt.min,cn=i.now,ln=e.parseInt,fn=dt.random,hn=gt.reverse,dn=to(e,"DataView"),pn=to(e,"Map"),vn=to(e,"Promise"),mn=to(e,"Set"),yn=to(e,"WeakMap"),gn=to(pt,"create"),bn=yn&&new yn,_n={},wn=Mo(dn),xn=Mo(pn),jn=Mo(vn),On=Mo(mn),En=Mo(yn),Sn=kt?kt.prototype:void 0,zn=Sn?Sn.valueOf:void 0,Mn=Sn?Sn.toString:void 0;function An(t){if(Qa(t)&&!Ra(t)&&!(t instanceof In)){if(t instanceof Tn)return t;if(jt.call(t,"__wrapped__"))return Ao(t)}return new Tn(t)}var Cn=function(){function t(){}return function(e){if(!Wa(e))return{};if(Qt)return Qt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function kn(){}function Tn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}function In(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function Rn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Pn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Bn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Fn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Bn;++e<n;)this.add(t[e])}function Nn(t){var e=this.__data__=new Pn(t);this.size=e.size}function Ln(t,e){var n=Ra(t),r=!n&&Ia(t),i=!n&&!r&&Na(t),o=!n&&!r&&!i&&Ka(t),a=n||r||i||o,u=a?Ae(t.length,mt):[],s=u.length;for(var c in t)!e&&!jt.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||uo(c,s))||u.push(c);return u}function Dn(t){var e=t.length;return e?t[Fr(0,e-1)]:void 0}function Vn(t,e){return Eo(gi(t),Xn(e,0,t.length))}function Un(t){return Eo(gi(t))}function Gn(t,e,n){(void 0!==n&&!Ca(t[e],n)||void 0===n&&!(e in t))&&Zn(t,e,n)}function Wn(t,e,n){var r=t[e];jt.call(t,e)&&Ca(r,n)&&(void 0!==n||e in t)||Zn(t,e,n)}function Qn(t,e){for(var n=t.length;n--;)if(Ca(t[n][0],e))return n;return-1}function qn(t,e,n,r){return er(t,(function(t,i,o){e(r,t,n(t),o)})),r}function Hn(t,e){return t&&bi(e,wu(e),t)}function Zn(t,e,n){"__proto__"==e&&ge?ge(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function $n(t,e){for(var n=-1,i=e.length,o=r(i),a=null==t;++n<i;)o[n]=a?void 0:mu(t,e[n]);return o}function Xn(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}function Yn(t,e,n,r,i,o){var a,u=1&e,c=2&e,h=4&e;if(n&&(a=i?n(t,r,i,o):n(t)),void 0!==a)return a;if(!Wa(t))return t;var x=Ra(t);if(x){if(a=function(t){var e=t.length,n=new t.constructor(e);e&&"string"==typeof t[0]&&jt.call(t,"index")&&(n.index=t.index,n.input=t.input);return n}(t),!u)return gi(t,a)}else{var I=ro(t),R=I==d||I==p;if(Na(t))return hi(t,u);if(I==y||I==s||R&&!i){if(a=c||R?{}:oo(t),!u)return c?function(t,e){return bi(t,no(t),e)}(t,function(t,e){return t&&bi(e,xu(e),t)}(a,t)):function(t,e){return bi(t,eo(t),e)}(t,Hn(a,t))}else{if(!Vt[I])return i?t:{};a=function(t,e,n){var r=t.constructor;switch(e){case j:return di(t);case l:case f:return new r(+t);case O:return function(t,e){var n=e?di(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case E:case S:case z:case M:case A:case C:case"[object Uint8ClampedArray]":case k:case T:return pi(t,n);case v:return new r;case m:case _:return new r(t);case g:return function(t){var e=new t.constructor(t.source,rt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case b:return new r;case w:return i=t,zn?pt(zn.call(i)):{}}var i}(t,I,u)}}o||(o=new Nn);var P=o.get(t);if(P)return P;o.set(t,a),Xa(t)?t.forEach((function(r){a.add(Yn(r,e,n,r,t,o))})):qa(t)&&t.forEach((function(r,i){a.set(i,Yn(r,e,n,i,t,o))}));var B=x?void 0:(h?c?Hi:qi:c?xu:wu)(t);return ue(B||t,(function(r,i){B&&(r=t[i=r]),Wn(a,i,Yn(r,e,n,i,t,o))})),a}function Jn(t,e,n){var r=n.length;if(null==t)return!r;for(t=pt(t);r--;){var i=n[r],o=e[i],a=t[i];if(void 0===a&&!(i in t)||!o(a))return!1}return!0}function Kn(t,e,n){if("function"!=typeof t)throw new yt(o);return wo((function(){t.apply(void 0,n)}),e)}function tr(t,e,n,r){var i=-1,o=fe,a=!0,u=t.length,s=[],c=e.length;if(!u)return s;n&&(e=de(e,ke(n))),r?(o=he,a=!1):e.length>=200&&(o=Ie,a=!1,e=new Fn(e));t:for(;++i<u;){var l=t[i],f=null==n?l:n(l);if(l=r||0!==l?l:0,a&&f==f){for(var h=c;h--;)if(e[h]===f)continue t;s.push(l)}else o(e,f,r)||s.push(l)}return s}An.templateSettings={escape:D,evaluate:V,interpolate:U,variable:"",imports:{_:An}},An.prototype=kn.prototype,An.prototype.constructor=An,Tn.prototype=Cn(kn.prototype),Tn.prototype.constructor=Tn,In.prototype=Cn(kn.prototype),In.prototype.constructor=In,Rn.prototype.clear=function(){this.__data__=gn?gn(null):{},this.size=0},Rn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Rn.prototype.get=function(t){var e=this.__data__;if(gn){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return jt.call(e,t)?e[t]:void 0},Rn.prototype.has=function(t){var e=this.__data__;return gn?void 0!==e[t]:jt.call(e,t)},Rn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=gn&&void 0===e?"__lodash_hash_undefined__":e,this},Pn.prototype.clear=function(){this.__data__=[],this.size=0},Pn.prototype.delete=function(t){var e=this.__data__,n=Qn(e,t);return!(n<0)&&(n==e.length-1?e.pop():Zt.call(e,n,1),--this.size,!0)},Pn.prototype.get=function(t){var e=this.__data__,n=Qn(e,t);return n<0?void 0:e[n][1]},Pn.prototype.has=function(t){return Qn(this.__data__,t)>-1},Pn.prototype.set=function(t,e){var n=this.__data__,r=Qn(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},Bn.prototype.clear=function(){this.size=0,this.__data__={hash:new Rn,map:new(pn||Pn),string:new Rn}},Bn.prototype.delete=function(t){var e=Ji(this,t).delete(t);return this.size-=e?1:0,e},Bn.prototype.get=function(t){return Ji(this,t).get(t)},Bn.prototype.has=function(t){return Ji(this,t).has(t)},Bn.prototype.set=function(t,e){var n=Ji(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Fn.prototype.add=Fn.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Fn.prototype.has=function(t){return this.__data__.has(t)},Nn.prototype.clear=function(){this.__data__=new Pn,this.size=0},Nn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Nn.prototype.get=function(t){return this.__data__.get(t)},Nn.prototype.has=function(t){return this.__data__.has(t)},Nn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Pn){var r=n.__data__;if(!pn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Bn(r)}return n.set(t,e),this.size=n.size,this};var er=xi(cr),nr=xi(lr,!0);function rr(t,e){var n=!0;return er(t,(function(t,r,i){return n=!!e(t,r,i)})),n}function ir(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=e(o);if(null!=a&&(void 0===u?a==a&&!Ja(a):n(a,u)))var u=a,s=o}return s}function or(t,e){var n=[];return er(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}function ar(t,e,n,r,i){var o=-1,a=t.length;for(n||(n=ao),i||(i=[]);++o<a;){var u=t[o];e>0&&n(u)?e>1?ar(u,e-1,n,r,i):pe(i,u):r||(i[i.length]=u)}return i}var ur=ji(),sr=ji(!0);function cr(t,e){return t&&ur(t,e,wu)}function lr(t,e){return t&&sr(t,e,wu)}function fr(t,e){return le(e,(function(e){return Va(t[e])}))}function hr(t,e){for(var n=0,r=(e=si(e,t)).length;null!=t&&n<r;)t=t[zo(e[n++])];return n&&n==r?t:void 0}function dr(t,e,n){var r=e(t);return Ra(t)?r:pe(r,n(t))}function pr(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Jt&&Jt in pt(t)?function(t){var e=jt.call(t,Jt),n=t[Jt];try{t[Jt]=void 0;var r=!0}catch(o){}var i=St.call(t);r&&(e?t[Jt]=n:delete t[Jt]);return i}(t):function(t){return St.call(t)}(t)}function vr(t,e){return t>e}function mr(t,e){return null!=t&&jt.call(t,e)}function yr(t,e){return null!=t&&e in pt(t)}function gr(t,e,n){for(var i=n?he:fe,o=t[0].length,a=t.length,u=a,s=r(a),c=1/0,l=[];u--;){var f=t[u];u&&e&&(f=de(f,ke(e))),c=sn(f.length,c),s[u]=!n&&(e||o>=120&&f.length>=120)?new Fn(u&&f):void 0}f=t[0];var h=-1,d=s[0];t:for(;++h<o&&l.length<c;){var p=f[h],v=e?e(p):p;if(p=n||0!==p?p:0,!(d?Ie(d,v):i(l,v,n))){for(u=a;--u;){var m=s[u];if(!(m?Ie(m,v):i(t[u],v,n)))continue t}d&&d.push(v),l.push(p)}}return l}function br(t,e,n){var r=null==(t=yo(t,e=si(e,t)))?t:t[zo(Do(e))];return null==r?void 0:oe(r,t,n)}function _r(t){return Qa(t)&&pr(t)==s}function wr(t,e,n,r,i){return t===e||(null==t||null==e||!Qa(t)&&!Qa(e)?t!=t&&e!=e:function(t,e,n,r,i,o){var a=Ra(t),u=Ra(e),d=a?c:ro(t),p=u?c:ro(e),x=(d=d==s?y:d)==y,E=(p=p==s?y:p)==y,S=d==p;if(S&&Na(t)){if(!Na(e))return!1;a=!0,x=!1}if(S&&!x)return o||(o=new Nn),a||Ka(t)?Wi(t,e,n,r,i,o):function(t,e,n,r,i,o,a){switch(n){case O:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case j:return!(t.byteLength!=e.byteLength||!o(new Rt(t),new Rt(e)));case l:case f:case m:return Ca(+t,+e);case h:return t.name==e.name&&t.message==e.message;case g:case _:return t==e+"";case v:var u=Ve;case b:var s=1&r;if(u||(u=We),t.size!=e.size&&!s)return!1;var c=a.get(t);if(c)return c==e;r|=2,a.set(t,e);var d=Wi(u(t),u(e),r,i,o,a);return a.delete(t),d;case w:if(zn)return zn.call(t)==zn.call(e)}return!1}(t,e,d,n,r,i,o);if(!(1&n)){var z=x&&jt.call(t,"__wrapped__"),M=E&&jt.call(e,"__wrapped__");if(z||M){var A=z?t.value():t,C=M?e.value():e;return o||(o=new Nn),i(A,C,n,r,o)}}if(!S)return!1;return o||(o=new Nn),function(t,e,n,r,i,o){var a=1&n,u=qi(t),s=u.length,c=qi(e).length;if(s!=c&&!a)return!1;var l=s;for(;l--;){var f=u[l];if(!(a?f in e:jt.call(e,f)))return!1}var h=o.get(t),d=o.get(e);if(h&&d)return h==e&&d==t;var p=!0;o.set(t,e),o.set(e,t);var v=a;for(;++l<s;){f=u[l];var m=t[f],y=e[f];if(r)var g=a?r(y,m,f,e,t,o):r(m,y,f,t,e,o);if(!(void 0===g?m===y||i(m,y,n,r,o):g)){p=!1;break}v||(v="constructor"==f)}if(p&&!v){var b=t.constructor,_=e.constructor;b==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _||(p=!1)}return o.delete(t),o.delete(e),p}(t,e,n,r,i,o)}(t,e,n,r,wr,i))}function xr(t,e,n,r){var i=n.length,o=i,a=!r;if(null==t)return!o;for(t=pt(t);i--;){var u=n[i];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<o;){var s=(u=n[i])[0],c=t[s],l=u[1];if(a&&u[2]){if(void 0===c&&!(s in t))return!1}else{var f=new Nn;if(r)var h=r(c,l,s,t,e,f);if(!(void 0===h?wr(l,c,3,r,f):h))return!1}}return!0}function jr(t){return!(!Wa(t)||(e=t,Et&&Et in e))&&(Va(t)?At:at).test(Mo(t));var e}function Or(t){return"function"==typeof t?t:null==t?Hu:"object"==typeof t?Ra(t)?Cr(t[0],t[1]):Ar(t):ns(t)}function Er(t){if(!ho(t))return an(t);var e=[];for(var n in pt(t))jt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Sr(t){if(!Wa(t))return function(t){var e=[];if(null!=t)for(var n in pt(t))e.push(n);return e}(t);var e=ho(t),n=[];for(var r in t)("constructor"!=r||!e&&jt.call(t,r))&&n.push(r);return n}function zr(t,e){return t<e}function Mr(t,e){var n=-1,i=Ba(t)?r(t.length):[];return er(t,(function(t,r,o){i[++n]=e(t,r,o)})),i}function Ar(t){var e=Ki(t);return 1==e.length&&e[0][2]?vo(e[0][0],e[0][1]):function(n){return n===t||xr(n,t,e)}}function Cr(t,e){return co(t)&&po(e)?vo(zo(t),e):function(n){var r=mu(n,t);return void 0===r&&r===e?yu(n,t):wr(e,r,3)}}function kr(t,e,n,r,i){t!==e&&ur(e,(function(o,a){if(i||(i=new Nn),Wa(o))!function(t,e,n,r,i,o,a){var u=bo(t,n),s=bo(e,n),c=a.get(s);if(c)return void Gn(t,n,c);var l=o?o(u,s,n+"",t,e,a):void 0,f=void 0===l;if(f){var h=Ra(s),d=!h&&Na(s),p=!h&&!d&&Ka(s);l=s,h||d||p?Ra(u)?l=u:Fa(u)?l=gi(u):d?(f=!1,l=hi(s,!0)):p?(f=!1,l=pi(s,!0)):l=[]:Za(s)||Ia(s)?(l=u,Ia(u)?l=uu(u):Wa(u)&&!Va(u)||(l=oo(s))):f=!1}f&&(a.set(s,l),i(l,s,r,o,a),a.delete(s));Gn(t,n,l)}(t,e,a,n,kr,r,i);else{var u=r?r(bo(t,a),o,a+"",t,e,i):void 0;void 0===u&&(u=o),Gn(t,a,u)}}),xu)}function Tr(t,e){var n=t.length;if(n)return uo(e+=e<0?n:0,n)?t[e]:void 0}function Ir(t,e,n){e=e.length?de(e,(function(t){return Ra(t)?function(e){return hr(e,1===t.length?t[0]:t)}:t})):[Hu];var r=-1;return e=de(e,ke(Yi())),function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}(Mr(t,(function(t,n,i){return{criteria:de(e,(function(e){return e(t)})),index:++r,value:t}})),(function(t,e){return function(t,e,n){var r=-1,i=t.criteria,o=e.criteria,a=i.length,u=n.length;for(;++r<a;){var s=vi(i[r],o[r]);if(s){if(r>=u)return s;var c=n[r];return s*("desc"==c?-1:1)}}return t.index-e.index}(t,e,n)}))}function Rr(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var a=e[r],u=hr(t,a);n(u,a)&&Ur(o,si(a,t),u)}return o}function Pr(t,e,n,r){var i=r?xe:we,o=-1,a=e.length,u=t;for(t===e&&(e=gi(e)),n&&(u=de(t,ke(n)));++o<a;)for(var s=0,c=e[o],l=n?n(c):c;(s=i(u,l,s,r))>-1;)u!==t&&Zt.call(u,s,1),Zt.call(t,s,1);return t}function Br(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;uo(i)?Zt.call(t,i,1):ti(t,i)}}return t}function Fr(t,e){return t+tn(fn()*(e-t+1))}function Nr(t,e){var n="";if(!t||e<1||e>9007199254740991)return n;do{e%2&&(n+=t),(e=tn(e/2))&&(t+=t)}while(e);return n}function Lr(t,e){return xo(mo(t,e,Hu),t+"")}function Dr(t){return Dn(Cu(t))}function Vr(t,e){var n=Cu(t);return Eo(n,Xn(e,0,n.length))}function Ur(t,e,n,r){if(!Wa(t))return t;for(var i=-1,o=(e=si(e,t)).length,a=o-1,u=t;null!=u&&++i<o;){var s=zo(e[i]),c=n;if("__proto__"===s||"constructor"===s||"prototype"===s)return t;if(i!=a){var l=u[s];void 0===(c=r?r(l,s,u):void 0)&&(c=Wa(l)?l:uo(e[i+1])?[]:{})}Wn(u,s,c),u=u[s]}return t}var Gr=bn?function(t,e){return bn.set(t,e),t}:Hu,Wr=ge?function(t,e){return ge(t,"toString",{configurable:!0,enumerable:!1,value:Wu(e),writable:!0})}:Hu;function Qr(t){return Eo(Cu(t))}function qr(t,e,n){var i=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var a=r(o);++i<o;)a[i]=t[i+e];return a}function Hr(t,e){var n;return er(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n}function Zr(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var o=r+i>>>1,a=t[o];null!==a&&!Ja(a)&&(n?a<=e:a<e)?r=o+1:i=o}return i}return $r(t,e,Hu,n)}function $r(t,e,n,r){var i=0,o=null==t?0:t.length;if(0===o)return 0;for(var a=(e=n(e))!=e,u=null===e,s=Ja(e),c=void 0===e;i<o;){var l=tn((i+o)/2),f=n(t[l]),h=void 0!==f,d=null===f,p=f==f,v=Ja(f);if(a)var m=r||p;else m=c?p&&(r||h):u?p&&h&&(r||!d):s?p&&h&&!d&&(r||!v):!d&&!v&&(r?f<=e:f<e);m?i=l+1:o=l}return sn(o,4294967294)}function Xr(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var a=t[n],u=e?e(a):a;if(!n||!Ca(u,s)){var s=u;o[i++]=0===a?0:a}}return o}function Yr(t){return"number"==typeof t?t:Ja(t)?NaN:+t}function Jr(t){if("string"==typeof t)return t;if(Ra(t))return de(t,Jr)+"";if(Ja(t))return Mn?Mn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Kr(t,e,n){var r=-1,i=fe,o=t.length,a=!0,u=[],s=u;if(n)a=!1,i=he;else if(o>=200){var c=e?null:Ni(t);if(c)return We(c);a=!1,i=Ie,s=new Fn}else s=e?[]:u;t:for(;++r<o;){var l=t[r],f=e?e(l):l;if(l=n||0!==l?l:0,a&&f==f){for(var h=s.length;h--;)if(s[h]===f)continue t;e&&s.push(f),u.push(l)}else i(s,f,n)||(s!==u&&s.push(f),u.push(l))}return u}function ti(t,e){return null==(t=yo(t,e=si(e,t)))||delete t[zo(Do(e))]}function ei(t,e,n,r){return Ur(t,e,n(hr(t,e)),r)}function ni(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?qr(t,r?0:o,r?o+1:i):qr(t,r?o+1:0,r?i:o)}function ri(t,e){var n=t;return n instanceof In&&(n=n.value()),ve(e,(function(t,e){return e.func.apply(e.thisArg,pe([t],e.args))}),n)}function ii(t,e,n){var i=t.length;if(i<2)return i?Kr(t[0]):[];for(var o=-1,a=r(i);++o<i;)for(var u=t[o],s=-1;++s<i;)s!=o&&(a[o]=tr(a[o]||u,t[s],e,n));return Kr(ar(a,1),e,n)}function oi(t,e,n){for(var r=-1,i=t.length,o=e.length,a={};++r<i;){var u=r<o?e[r]:void 0;n(a,t[r],u)}return a}function ai(t){return Fa(t)?t:[]}function ui(t){return"function"==typeof t?t:Hu}function si(t,e){return Ra(t)?t:co(t,e)?[t]:So(su(t))}var ci=Lr;function li(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&n>=r?t:qr(t,e,n)}var fi=Se||function(t){return Ht.clearTimeout(t)};function hi(t,e){if(e)return t.slice();var n=t.length,r=Bt?Bt(n):new t.constructor(n);return t.copy(r),r}function di(t){var e=new t.constructor(t.byteLength);return new Rt(e).set(new Rt(t)),e}function pi(t,e){var n=e?di(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function vi(t,e){if(t!==e){var n=void 0!==t,r=null===t,i=t==t,o=Ja(t),a=void 0!==e,u=null===e,s=e==e,c=Ja(e);if(!u&&!c&&!o&&t>e||o&&a&&s&&!u&&!c||r&&a&&s||!n&&s||!i)return 1;if(!r&&!o&&!c&&t<e||c&&n&&i&&!r&&!o||u&&n&&i||!a&&i||!s)return-1}return 0}function mi(t,e,n,i){for(var o=-1,a=t.length,u=n.length,s=-1,c=e.length,l=un(a-u,0),f=r(c+l),h=!i;++s<c;)f[s]=e[s];for(;++o<u;)(h||o<a)&&(f[n[o]]=t[o]);for(;l--;)f[s++]=t[o++];return f}function yi(t,e,n,i){for(var o=-1,a=t.length,u=-1,s=n.length,c=-1,l=e.length,f=un(a-s,0),h=r(f+l),d=!i;++o<f;)h[o]=t[o];for(var p=o;++c<l;)h[p+c]=e[c];for(;++u<s;)(d||o<a)&&(h[p+n[u]]=t[o++]);return h}function gi(t,e){var n=-1,i=t.length;for(e||(e=r(i));++n<i;)e[n]=t[n];return e}function bi(t,e,n,r){var i=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var u=e[o],s=r?r(n[u],t[u],u,n,t):void 0;void 0===s&&(s=t[u]),i?Zn(n,u,s):Wn(n,u,s)}return n}function _i(t,e){return function(n,r){var i=Ra(n)?ae:qn,o=e?e():{};return i(n,t,Yi(r,2),o)}}function wi(t){return Lr((function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,a&&so(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),e=pt(e);++r<i;){var u=n[r];u&&t(e,u,r,o)}return e}))}function xi(t,e){return function(n,r){if(null==n)return n;if(!Ba(n))return t(n,r);for(var i=n.length,o=e?i:-1,a=pt(n);(e?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function ji(t){return function(e,n,r){for(var i=-1,o=pt(e),a=r(e),u=a.length;u--;){var s=a[t?u:++i];if(!1===n(o[s],s,o))break}return e}}function Oi(t){return function(e){var n=De(e=su(e))?He(e):void 0,r=n?n[0]:e.charAt(0),i=n?li(n,1).join(""):e.slice(1);return r[t]()+i}}function Ei(t){return function(e){return ve(Vu(Iu(e).replace(Tt,"")),t,"")}}function Si(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Cn(t.prototype),r=t.apply(n,e);return Wa(r)?r:n}}function zi(t){return function(e,n,r){var i=pt(e);if(!Ba(e)){var o=Yi(n,3);e=wu(e),n=function(t){return o(i[t],t,i)}}var a=t(e,n,r);return a>-1?i[o?e[a]:a]:void 0}}function Mi(t){return Qi((function(e){var n=e.length,r=n,i=Tn.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new yt(o);if(i&&!u&&"wrapper"==$i(a))var u=new Tn([],!0)}for(r=u?r:n;++r<n;){var s=$i(a=e[r]),c="wrapper"==s?Zi(a):void 0;u=c&&lo(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?u[$i(c[0])].apply(u,c[3]):1==a.length&&lo(a)?u[s]():u.thru(a)}return function(){var t=arguments,r=t[0];if(u&&1==t.length&&Ra(r))return u.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}}))}function Ai(t,e,n,i,o,a,u,s,c,l){var f=128&e,h=1&e,d=2&e,p=24&e,v=512&e,m=d?void 0:Si(t);return function y(){for(var g=arguments.length,b=r(g),_=g;_--;)b[_]=arguments[_];if(p)var w=Xi(y),x=Be(b,w);if(i&&(b=mi(b,i,o,p)),a&&(b=yi(b,a,u,p)),g-=x,p&&g<l){var j=Ge(b,w);return Bi(t,e,Ai,y.placeholder,n,b,j,s,c,l-g)}var O=h?n:this,E=d?O[t]:t;return g=b.length,s?b=go(b,s):v&&g>1&&b.reverse(),f&&c<g&&(b.length=c),this&&this!==Ht&&this instanceof y&&(E=m||Si(E)),E.apply(O,b)}}function Ci(t,e){return function(n,r){return function(t,e,n,r){return cr(t,(function(t,i,o){e(r,n(t),i,o)})),r}(n,t,e(r),{})}}function ki(t,e){return function(n,r){var i;if(void 0===n&&void 0===r)return e;if(void 0!==n&&(i=n),void 0!==r){if(void 0===i)return r;"string"==typeof n||"string"==typeof r?(n=Jr(n),r=Jr(r)):(n=Yr(n),r=Yr(r)),i=t(n,r)}return i}}function Ti(t){return Qi((function(e){return e=de(e,ke(Yi())),Lr((function(n){var r=this;return t(e,(function(t){return oe(t,r,n)}))}))}))}function Ii(t,e){var n=(e=void 0===e?" ":Jr(e)).length;if(n<2)return n?Nr(e,t):e;var r=Nr(e,Ke(t/qe(e)));return De(e)?li(He(r),0,t).join(""):r.slice(0,t)}function Ri(t){return function(e,n,i){return i&&"number"!=typeof i&&so(e,n,i)&&(n=i=void 0),e=ru(e),void 0===n?(n=e,e=0):n=ru(n),function(t,e,n,i){for(var o=-1,a=un(Ke((e-t)/(n||1)),0),u=r(a);a--;)u[i?a:++o]=t,t+=n;return u}(e,n,i=void 0===i?e<n?1:-1:ru(i),t)}}function Pi(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=au(e),n=au(n)),t(e,n)}}function Bi(t,e,n,r,i,o,a,u,s,c){var l=8&e;e|=l?32:64,4&(e&=~(l?64:32))||(e&=-4);var f=[t,e,i,l?o:void 0,l?a:void 0,l?void 0:o,l?void 0:a,u,s,c],h=n.apply(void 0,f);return lo(t)&&_o(h,f),h.placeholder=r,jo(h,t,e)}function Fi(t){var e=dt[t];return function(t,n){if(t=au(t),(n=null==n?0:sn(iu(n),292))&&rn(t)){var r=(su(t)+"e").split("e");return+((r=(su(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Ni=mn&&1/We(new mn([,-0]))[1]==1/0?function(t){return new mn(t)}:Ju;function Li(t){return function(e){var n=ro(e);return n==v?Ve(e):n==b?Qe(e):function(t,e){return de(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Di(t,e,n,i,u,s,c,l){var f=2&e;if(!f&&"function"!=typeof t)throw new yt(o);var h=i?i.length:0;if(h||(e&=-97,i=u=void 0),c=void 0===c?c:un(iu(c),0),l=void 0===l?l:iu(l),h-=u?u.length:0,64&e){var d=i,p=u;i=u=void 0}var v=f?void 0:Zi(t),m=[t,e,n,i,u,d,p,s,c,l];if(v&&function(t,e){var n=t[1],r=e[1],i=n|r,o=i<131,u=128==r&&8==n||128==r&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!o&&!u)return t;1&r&&(t[2]=e[2],i|=1&n?0:4);var s=e[3];if(s){var c=t[3];t[3]=c?mi(c,s,e[4]):s,t[4]=c?Ge(t[3],a):e[4]}(s=e[5])&&(c=t[5],t[5]=c?yi(c,s,e[6]):s,t[6]=c?Ge(t[5],a):e[6]);(s=e[7])&&(t[7]=s);128&r&&(t[8]=null==t[8]?e[8]:sn(t[8],e[8]));null==t[9]&&(t[9]=e[9]);t[0]=e[0],t[1]=i}(m,v),t=m[0],e=m[1],n=m[2],i=m[3],u=m[4],!(l=m[9]=void 0===m[9]?f?0:t.length:un(m[9]-h,0))&&24&e&&(e&=-25),e&&1!=e)y=8==e||16==e?function(t,e,n){var i=Si(t);return function o(){for(var a=arguments.length,u=r(a),s=a,c=Xi(o);s--;)u[s]=arguments[s];var l=a<3&&u[0]!==c&&u[a-1]!==c?[]:Ge(u,c);if((a-=l.length)<n)return Bi(t,e,Ai,o.placeholder,void 0,u,l,void 0,void 0,n-a);var f=this&&this!==Ht&&this instanceof o?i:t;return oe(f,this,u)}}(t,e,l):32!=e&&33!=e||u.length?Ai.apply(void 0,m):function(t,e,n,i){var o=1&e,a=Si(t);return function e(){for(var u=-1,s=arguments.length,c=-1,l=i.length,f=r(l+s),h=this&&this!==Ht&&this instanceof e?a:t;++c<l;)f[c]=i[c];for(;s--;)f[c++]=arguments[++u];return oe(h,o?n:this,f)}}(t,e,n,i);else var y=function(t,e,n){var r=1&e,i=Si(t);return function e(){var o=this&&this!==Ht&&this instanceof e?i:t;return o.apply(r?n:this,arguments)}}(t,e,n);return jo((v?Gr:_o)(y,m),t,e)}function Vi(t,e,n,r){return void 0===t||Ca(t,_t[n])&&!jt.call(r,n)?e:t}function Ui(t,e,n,r,i,o){return Wa(t)&&Wa(e)&&(o.set(e,t),kr(t,e,void 0,Ui,o),o.delete(e)),t}function Gi(t){return Za(t)?void 0:t}function Wi(t,e,n,r,i,o){var a=1&n,u=t.length,s=e.length;if(u!=s&&!(a&&s>u))return!1;var c=o.get(t),l=o.get(e);if(c&&l)return c==e&&l==t;var f=-1,h=!0,d=2&n?new Fn:void 0;for(o.set(t,e),o.set(e,t);++f<u;){var p=t[f],v=e[f];if(r)var m=a?r(v,p,f,e,t,o):r(p,v,f,t,e,o);if(void 0!==m){if(m)continue;h=!1;break}if(d){if(!ye(e,(function(t,e){if(!Ie(d,e)&&(p===t||i(p,t,n,r,o)))return d.push(e)}))){h=!1;break}}else if(p!==v&&!i(p,v,n,r,o)){h=!1;break}}return o.delete(t),o.delete(e),h}function Qi(t){return xo(mo(t,void 0,Po),t+"")}function qi(t){return dr(t,wu,eo)}function Hi(t){return dr(t,xu,no)}var Zi=bn?function(t){return bn.get(t)}:Ju;function $i(t){for(var e=t.name+"",n=_n[e],r=jt.call(_n,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function Xi(t){return(jt.call(An,"placeholder")?An:t).placeholder}function Yi(){var t=An.iteratee||Zu;return t=t===Zu?Or:t,arguments.length?t(arguments[0],arguments[1]):t}function Ji(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function Ki(t){for(var e=wu(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,po(i)]}return e}function to(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return jr(n)?n:void 0}var eo=en?function(t){return null==t?[]:(t=pt(t),le(en(t),(function(e){return qt.call(t,e)})))}:os,no=en?function(t){for(var e=[];t;)pe(e,eo(t)),t=Ut(t);return e}:os,ro=pr;function io(t,e,n){for(var r=-1,i=(e=si(e,t)).length,o=!1;++r<i;){var a=zo(e[r]);if(!(o=null!=t&&n(t,a)))break;t=t[a]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&Ga(i)&&uo(a,i)&&(Ra(t)||Ia(t))}function oo(t){return"function"!=typeof t.constructor||ho(t)?{}:Cn(Ut(t))}function ao(t){return Ra(t)||Ia(t)||!!($t&&t&&t[$t])}function uo(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&st.test(t))&&t>-1&&t%1==0&&t<e}function so(t,e,n){if(!Wa(n))return!1;var r=typeof e;return!!("number"==r?Ba(n)&&uo(e,n.length):"string"==r&&e in n)&&Ca(n[e],t)}function co(t,e){if(Ra(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Ja(t))||(W.test(t)||!G.test(t)||null!=e&&t in pt(e))}function lo(t){var e=$i(t),n=An[e];if("function"!=typeof n||!(e in In.prototype))return!1;if(t===n)return!0;var r=Zi(n);return!!r&&t===r[0]}(dn&&ro(new dn(new ArrayBuffer(1)))!=O||pn&&ro(new pn)!=v||vn&&"[object Promise]"!=ro(vn.resolve())||mn&&ro(new mn)!=b||yn&&ro(new yn)!=x)&&(ro=function(t){var e=pr(t),n=e==y?t.constructor:void 0,r=n?Mo(n):"";if(r)switch(r){case wn:return O;case xn:return v;case jn:return"[object Promise]";case On:return b;case En:return x}return e});var fo=wt?Va:as;function ho(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||_t)}function po(t){return t==t&&!Wa(t)}function vo(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in pt(n)))}}function mo(t,e,n){return e=un(void 0===e?t.length-1:e,0),function(){for(var i=arguments,o=-1,a=un(i.length-e,0),u=r(a);++o<a;)u[o]=i[e+o];o=-1;for(var s=r(e+1);++o<e;)s[o]=i[o];return s[e]=n(u),oe(t,this,s)}}function yo(t,e){return e.length<2?t:hr(t,qr(e,0,-1))}function go(t,e){for(var n=t.length,r=sn(e.length,n),i=gi(t);r--;){var o=e[r];t[r]=uo(o,n)?i[o]:void 0}return t}function bo(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var _o=Oo(Gr),wo=Je||function(t,e){return Ht.setTimeout(t,e)},xo=Oo(Wr);function jo(t,e,n){var r=e+"";return xo(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(X,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return ue(u,(function(n){var r="_."+n[0];e&n[1]&&!fe(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(Y);return e?e[1].split(J):[]}(r),n)))}function Oo(t){var e=0,n=0;return function(){var r=cn(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Eo(t,e){var n=-1,r=t.length,i=r-1;for(e=void 0===e?r:e;++n<e;){var o=Fr(n,i),a=t[o];t[o]=t[n],t[n]=a}return t.length=e,t}var So=function(t){var e=Oa(t,(function(t){return 500===n.size&&n.clear(),t})),n=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Q,(function(t,n,r,i){e.push(r?i.replace(et,"$1"):n||t)})),e}));function zo(t){if("string"==typeof t||Ja(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Mo(t){if(null!=t){try{return xt.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function Ao(t){if(t instanceof In)return t.clone();var e=new Tn(t.__wrapped__,t.__chain__);return e.__actions__=gi(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Co=Lr((function(t,e){return Fa(t)?tr(t,ar(e,1,Fa,!0)):[]})),ko=Lr((function(t,e){var n=Do(e);return Fa(n)&&(n=void 0),Fa(t)?tr(t,ar(e,1,Fa,!0),Yi(n,2)):[]})),To=Lr((function(t,e){var n=Do(e);return Fa(n)&&(n=void 0),Fa(t)?tr(t,ar(e,1,Fa,!0),void 0,n):[]}));function Io(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:iu(n);return i<0&&(i=un(r+i,0)),_e(t,Yi(e,3),i)}function Ro(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=iu(n),i=n<0?un(r+i,0):sn(i,r-1)),_e(t,Yi(e,3),i,!0)}function Po(t){return(null==t?0:t.length)?ar(t,1):[]}function Bo(t){return t&&t.length?t[0]:void 0}var Fo=Lr((function(t){var e=de(t,ai);return e.length&&e[0]===t[0]?gr(e):[]})),No=Lr((function(t){var e=Do(t),n=de(t,ai);return e===Do(n)?e=void 0:n.pop(),n.length&&n[0]===t[0]?gr(n,Yi(e,2)):[]})),Lo=Lr((function(t){var e=Do(t),n=de(t,ai);return(e="function"==typeof e?e:void 0)&&n.pop(),n.length&&n[0]===t[0]?gr(n,void 0,e):[]}));function Do(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}var Vo=Lr(Uo);function Uo(t,e){return t&&t.length&&e&&e.length?Pr(t,e):t}var Go=Qi((function(t,e){var n=null==t?0:t.length,r=$n(t,e);return Br(t,de(e,(function(t){return uo(t,n)?+t:t})).sort(vi)),r}));function Wo(t){return null==t?t:hn.call(t)}var Qo=Lr((function(t){return Kr(ar(t,1,Fa,!0))})),qo=Lr((function(t){var e=Do(t);return Fa(e)&&(e=void 0),Kr(ar(t,1,Fa,!0),Yi(e,2))})),Ho=Lr((function(t){var e=Do(t);return e="function"==typeof e?e:void 0,Kr(ar(t,1,Fa,!0),void 0,e)}));function Zo(t){if(!t||!t.length)return[];var e=0;return t=le(t,(function(t){if(Fa(t))return e=un(t.length,e),!0})),Ae(e,(function(e){return de(t,Ee(e))}))}function $o(t,e){if(!t||!t.length)return[];var n=Zo(t);return null==e?n:de(n,(function(t){return oe(e,void 0,t)}))}var Xo=Lr((function(t,e){return Fa(t)?tr(t,e):[]})),Yo=Lr((function(t){return ii(le(t,Fa))})),Jo=Lr((function(t){var e=Do(t);return Fa(e)&&(e=void 0),ii(le(t,Fa),Yi(e,2))})),Ko=Lr((function(t){var e=Do(t);return e="function"==typeof e?e:void 0,ii(le(t,Fa),void 0,e)})),ta=Lr(Zo);var ea=Lr((function(t){var e=t.length,n=e>1?t[e-1]:void 0;return n="function"==typeof n?(t.pop(),n):void 0,$o(t,n)}));function na(t){var e=An(t);return e.__chain__=!0,e}function ra(t,e){return e(t)}var ia=Qi((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return $n(e,t)};return!(e>1||this.__actions__.length)&&r instanceof In&&uo(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:ra,args:[i],thisArg:void 0}),new Tn(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(void 0),t}))):this.thru(i)}));var oa=_i((function(t,e,n){jt.call(t,n)?++t[n]:Zn(t,n,1)}));var aa=zi(Io),ua=zi(Ro);function sa(t,e){return(Ra(t)?ue:er)(t,Yi(e,3))}function ca(t,e){return(Ra(t)?se:nr)(t,Yi(e,3))}var la=_i((function(t,e,n){jt.call(t,n)?t[n].push(e):Zn(t,n,[e])}));var fa=Lr((function(t,e,n){var i=-1,o="function"==typeof e,a=Ba(t)?r(t.length):[];return er(t,(function(t){a[++i]=o?oe(e,t,n):br(t,e,n)})),a})),ha=_i((function(t,e,n){Zn(t,n,e)}));function da(t,e){return(Ra(t)?de:Mr)(t,Yi(e,3))}var pa=_i((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));var va=Lr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&so(t,e[0],e[1])?e=[]:n>2&&so(e[0],e[1],e[2])&&(e=[e[0]]),Ir(t,ar(e,1),[])})),ma=Ye||function(){return Ht.Date.now()};function ya(t,e,n){return e=n?void 0:e,Di(t,128,void 0,void 0,void 0,void 0,e=t&&null==e?t.length:e)}function ga(t,e){var n;if("function"!=typeof e)throw new yt(o);return t=iu(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=void 0),n}}var ba=Lr((function(t,e,n){var r=1;if(n.length){var i=Ge(n,Xi(ba));r|=32}return Di(t,r,e,n,i)})),_a=Lr((function(t,e,n){var r=3;if(n.length){var i=Ge(n,Xi(_a));r|=32}return Di(e,r,t,n,i)}));function wa(t,e,n){var r,i,a,u,s,c,l=0,f=!1,h=!1,d=!0;if("function"!=typeof t)throw new yt(o);function p(e){var n=r,o=i;return r=i=void 0,l=e,u=t.apply(o,n)}function v(t){return l=t,s=wo(y,e),f?p(t):u}function m(t){var n=t-c;return void 0===c||n>=e||n<0||h&&t-l>=a}function y(){var t=ma();if(m(t))return g(t);s=wo(y,function(t){var n=e-(t-c);return h?sn(n,a-(t-l)):n}(t))}function g(t){return s=void 0,d&&r?p(t):(r=i=void 0,u)}function b(){var t=ma(),n=m(t);if(r=arguments,i=this,c=t,n){if(void 0===s)return v(c);if(h)return fi(s),s=wo(y,e),p(c)}return void 0===s&&(s=wo(y,e)),u}return e=au(e)||0,Wa(n)&&(f=!!n.leading,a=(h="maxWait"in n)?un(au(n.maxWait)||0,e):a,d="trailing"in n?!!n.trailing:d),b.cancel=function(){void 0!==s&&fi(s),l=0,r=c=i=s=void 0},b.flush=function(){return void 0===s?u:g(ma())},b}var xa=Lr((function(t,e){return Kn(t,1,e)})),ja=Lr((function(t,e,n){return Kn(t,au(e)||0,n)}));function Oa(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new yt(o);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(Oa.Cache||Bn),n}function Ea(t){if("function"!=typeof t)throw new yt(o);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Oa.Cache=Bn;var Sa=ci((function(t,e){var n=(e=1==e.length&&Ra(e[0])?de(e[0],ke(Yi())):de(ar(e,1),ke(Yi()))).length;return Lr((function(r){for(var i=-1,o=sn(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return oe(t,this,r)}))})),za=Lr((function(t,e){return Di(t,32,void 0,e,Ge(e,Xi(za)))})),Ma=Lr((function(t,e){return Di(t,64,void 0,e,Ge(e,Xi(Ma)))})),Aa=Qi((function(t,e){return Di(t,256,void 0,void 0,void 0,e)}));function Ca(t,e){return t===e||t!=t&&e!=e}var ka=Pi(vr),Ta=Pi((function(t,e){return t>=e})),Ia=_r(function(){return arguments}())?_r:function(t){return Qa(t)&&jt.call(t,"callee")&&!qt.call(t,"callee")},Ra=r.isArray,Pa=Kt?ke(Kt):function(t){return Qa(t)&&pr(t)==j};function Ba(t){return null!=t&&Ga(t.length)&&!Va(t)}function Fa(t){return Qa(t)&&Ba(t)}var Na=nn||as,La=te?ke(te):function(t){return Qa(t)&&pr(t)==f};function Da(t){if(!Qa(t))return!1;var e=pr(t);return e==h||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!Za(t)}function Va(t){if(!Wa(t))return!1;var e=pr(t);return e==d||e==p||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Ua(t){return"number"==typeof t&&t==iu(t)}function Ga(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function Wa(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Qa(t){return null!=t&&"object"==typeof t}var qa=ee?ke(ee):function(t){return Qa(t)&&ro(t)==v};function Ha(t){return"number"==typeof t||Qa(t)&&pr(t)==m}function Za(t){if(!Qa(t)||pr(t)!=y)return!1;var e=Ut(t);if(null===e)return!0;var n=jt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&xt.call(n)==zt}var $a=ne?ke(ne):function(t){return Qa(t)&&pr(t)==g};var Xa=re?ke(re):function(t){return Qa(t)&&ro(t)==b};function Ya(t){return"string"==typeof t||!Ra(t)&&Qa(t)&&pr(t)==_}function Ja(t){return"symbol"==typeof t||Qa(t)&&pr(t)==w}var Ka=ie?ke(ie):function(t){return Qa(t)&&Ga(t.length)&&!!Dt[pr(t)]};var tu=Pi(zr),eu=Pi((function(t,e){return t<=e}));function nu(t){if(!t)return[];if(Ba(t))return Ya(t)?He(t):gi(t);if(Yt&&t[Yt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Yt]());var e=ro(t);return(e==v?Ve:e==b?We:Cu)(t)}function ru(t){return t?(t=au(t))===1/0||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function iu(t){var e=ru(t),n=e%1;return e==e?n?e-n:e:0}function ou(t){return t?Xn(iu(t),0,4294967295):0}function au(t){if("number"==typeof t)return t;if(Ja(t))return NaN;if(Wa(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Wa(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ce(t);var n=ot.test(t);return n||ut.test(t)?Wt(t.slice(2),n?2:8):it.test(t)?NaN:+t}function uu(t){return bi(t,xu(t))}function su(t){return null==t?"":Jr(t)}var cu=wi((function(t,e){if(ho(e)||Ba(e))bi(e,wu(e),t);else for(var n in e)jt.call(e,n)&&Wn(t,n,e[n])})),lu=wi((function(t,e){bi(e,xu(e),t)})),fu=wi((function(t,e,n,r){bi(e,xu(e),t,r)})),hu=wi((function(t,e,n,r){bi(e,wu(e),t,r)})),du=Qi($n);var pu=Lr((function(t,e){t=pt(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&so(e[0],e[1],i)&&(r=1);++n<r;)for(var o=e[n],a=xu(o),u=-1,s=a.length;++u<s;){var c=a[u],l=t[c];(void 0===l||Ca(l,_t[c])&&!jt.call(t,c))&&(t[c]=o[c])}return t})),vu=Lr((function(t){return t.push(void 0,Ui),oe(Ou,void 0,t)}));function mu(t,e,n){var r=null==t?void 0:hr(t,e);return void 0===r?n:r}function yu(t,e){return null!=t&&io(t,e,yr)}var gu=Ci((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=St.call(e)),t[e]=n}),Wu(Hu)),bu=Ci((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=St.call(e)),jt.call(t,e)?t[e].push(n):t[e]=[n]}),Yi),_u=Lr(br);function wu(t){return Ba(t)?Ln(t):Er(t)}function xu(t){return Ba(t)?Ln(t,!0):Sr(t)}var ju=wi((function(t,e,n){kr(t,e,n)})),Ou=wi((function(t,e,n,r){kr(t,e,n,r)})),Eu=Qi((function(t,e){var n={};if(null==t)return n;var r=!1;e=de(e,(function(e){return e=si(e,t),r||(r=e.length>1),e})),bi(t,Hi(t),n),r&&(n=Yn(n,7,Gi));for(var i=e.length;i--;)ti(n,e[i]);return n}));var Su=Qi((function(t,e){return null==t?{}:function(t,e){return Rr(t,e,(function(e,n){return yu(t,n)}))}(t,e)}));function zu(t,e){if(null==t)return{};var n=de(Hi(t),(function(t){return[t]}));return e=Yi(e),Rr(t,n,(function(t,n){return e(t,n[0])}))}var Mu=Li(wu),Au=Li(xu);function Cu(t){return null==t?[]:Te(t,wu(t))}var ku=Ei((function(t,e,n){return e=e.toLowerCase(),t+(n?Tu(e):e)}));function Tu(t){return Du(su(t).toLowerCase())}function Iu(t){return(t=su(t))&&t.replace(ct,Fe).replace(It,"")}var Ru=Ei((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Pu=Ei((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Bu=Oi("toLowerCase");var Fu=Ei((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));var Nu=Ei((function(t,e,n){return t+(n?" ":"")+Du(e)}));var Lu=Ei((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Du=Oi("toUpperCase");function Vu(t,e,n){return t=su(t),void 0===(e=n?void 0:e)?function(t){return Ft.test(t)}(t)?function(t){return t.match(Pt)||[]}(t):function(t){return t.match(K)||[]}(t):t.match(e)||[]}var Uu=Lr((function(t,e){try{return oe(t,void 0,e)}catch(n){return Da(n)?n:new $(n)}})),Gu=Qi((function(t,e){return ue(e,(function(e){e=zo(e),Zn(t,e,ba(t[e],t))})),t}));function Wu(t){return function(){return t}}var Qu=Mi(),qu=Mi(!0);function Hu(t){return t}function Zu(t){return Or("function"==typeof t?t:Yn(t,1))}var $u=Lr((function(t,e){return function(n){return br(n,t,e)}})),Xu=Lr((function(t,e){return function(n){return br(t,n,e)}}));function Yu(t,e,n){var r=wu(e),i=fr(e,r);null!=n||Wa(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=fr(e,wu(e)));var o=!(Wa(n)&&"chain"in n&&!n.chain),a=Va(t);return ue(i,(function(n){var r=e[n];t[n]=r,a&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),i=n.__actions__=gi(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,pe([this.value()],arguments))})})),t}function Ju(){}var Ku=Ti(de),ts=Ti(ce),es=Ti(ye);function ns(t){return co(t)?Ee(zo(t)):function(t){return function(e){return hr(e,t)}}(t)}var rs=Ri(),is=Ri(!0);function os(){return[]}function as(){return!1}var us=ki((function(t,e){return t+e}),0),ss=Fi("ceil"),cs=ki((function(t,e){return t/e}),1),ls=Fi("floor");var fs,hs=ki((function(t,e){return t*e}),1),ds=Fi("round"),ps=ki((function(t,e){return t-e}),0);return An.after=function(t,e){if("function"!=typeof e)throw new yt(o);return t=iu(t),function(){if(--t<1)return e.apply(this,arguments)}},An.ary=ya,An.assign=cu,An.assignIn=lu,An.assignInWith=fu,An.assignWith=hu,An.at=du,An.before=ga,An.bind=ba,An.bindAll=Gu,An.bindKey=_a,An.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Ra(t)?t:[t]},An.chain=na,An.chunk=function(t,e,n){e=(n?so(t,e,n):void 0===e)?1:un(iu(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var o=0,a=0,u=r(Ke(i/e));o<i;)u[a++]=qr(t,o,o+=e);return u},An.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},An.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return pe(Ra(n)?gi(n):[n],ar(e,1))},An.cond=function(t){var e=null==t?0:t.length,n=Yi();return t=e?de(t,(function(t){if("function"!=typeof t[1])throw new yt(o);return[n(t[0]),t[1]]})):[],Lr((function(n){for(var r=-1;++r<e;){var i=t[r];if(oe(i[0],this,n))return oe(i[1],this,n)}}))},An.conforms=function(t){return function(t){var e=wu(t);return function(n){return Jn(n,t,e)}}(Yn(t,1))},An.constant=Wu,An.countBy=oa,An.create=function(t,e){var n=Cn(t);return null==e?n:Hn(n,e)},An.curry=function t(e,n,r){var i=Di(e,8,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=t.placeholder,i},An.curryRight=function t(e,n,r){var i=Di(e,16,void 0,void 0,void 0,void 0,void 0,n=r?void 0:n);return i.placeholder=t.placeholder,i},An.debounce=wa,An.defaults=pu,An.defaultsDeep=vu,An.defer=xa,An.delay=ja,An.difference=Co,An.differenceBy=ko,An.differenceWith=To,An.drop=function(t,e,n){var r=null==t?0:t.length;return r?qr(t,(e=n||void 0===e?1:iu(e))<0?0:e,r):[]},An.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?qr(t,0,(e=r-(e=n||void 0===e?1:iu(e)))<0?0:e):[]},An.dropRightWhile=function(t,e){return t&&t.length?ni(t,Yi(e,3),!0,!0):[]},An.dropWhile=function(t,e){return t&&t.length?ni(t,Yi(e,3),!0):[]},An.fill=function(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&so(t,e,n)&&(n=0,r=i),function(t,e,n,r){var i=t.length;for((n=iu(n))<0&&(n=-n>i?0:i+n),(r=void 0===r||r>i?i:iu(r))<0&&(r+=i),r=n>r?0:ou(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},An.filter=function(t,e){return(Ra(t)?le:or)(t,Yi(e,3))},An.flatMap=function(t,e){return ar(da(t,e),1)},An.flatMapDeep=function(t,e){return ar(da(t,e),1/0)},An.flatMapDepth=function(t,e,n){return n=void 0===n?1:iu(n),ar(da(t,e),n)},An.flatten=Po,An.flattenDeep=function(t){return(null==t?0:t.length)?ar(t,1/0):[]},An.flattenDepth=function(t,e){return(null==t?0:t.length)?ar(t,e=void 0===e?1:iu(e)):[]},An.flip=function(t){return Di(t,512)},An.flow=Qu,An.flowRight=qu,An.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},An.functions=function(t){return null==t?[]:fr(t,wu(t))},An.functionsIn=function(t){return null==t?[]:fr(t,xu(t))},An.groupBy=la,An.initial=function(t){return(null==t?0:t.length)?qr(t,0,-1):[]},An.intersection=Fo,An.intersectionBy=No,An.intersectionWith=Lo,An.invert=gu,An.invertBy=bu,An.invokeMap=fa,An.iteratee=Zu,An.keyBy=ha,An.keys=wu,An.keysIn=xu,An.map=da,An.mapKeys=function(t,e){var n={};return e=Yi(e,3),cr(t,(function(t,r,i){Zn(n,e(t,r,i),t)})),n},An.mapValues=function(t,e){var n={};return e=Yi(e,3),cr(t,(function(t,r,i){Zn(n,r,e(t,r,i))})),n},An.matches=function(t){return Ar(Yn(t,1))},An.matchesProperty=function(t,e){return Cr(t,Yn(e,1))},An.memoize=Oa,An.merge=ju,An.mergeWith=Ou,An.method=$u,An.methodOf=Xu,An.mixin=Yu,An.negate=Ea,An.nthArg=function(t){return t=iu(t),Lr((function(e){return Tr(e,t)}))},An.omit=Eu,An.omitBy=function(t,e){return zu(t,Ea(Yi(e)))},An.once=function(t){return ga(2,t)},An.orderBy=function(t,e,n,r){return null==t?[]:(Ra(e)||(e=null==e?[]:[e]),Ra(n=r?void 0:n)||(n=null==n?[]:[n]),Ir(t,e,n))},An.over=Ku,An.overArgs=Sa,An.overEvery=ts,An.overSome=es,An.partial=za,An.partialRight=Ma,An.partition=pa,An.pick=Su,An.pickBy=zu,An.property=ns,An.propertyOf=function(t){return function(e){return null==t?void 0:hr(t,e)}},An.pull=Vo,An.pullAll=Uo,An.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Pr(t,e,Yi(n,2)):t},An.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Pr(t,e,void 0,n):t},An.pullAt=Go,An.range=rs,An.rangeRight=is,An.rearg=Aa,An.reject=function(t,e){return(Ra(t)?le:or)(t,Ea(Yi(e,3)))},An.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=Yi(e,3);++r<o;){var a=t[r];e(a,r,t)&&(n.push(a),i.push(r))}return Br(t,i),n},An.rest=function(t,e){if("function"!=typeof t)throw new yt(o);return Lr(t,e=void 0===e?e:iu(e))},An.reverse=Wo,An.sampleSize=function(t,e,n){return e=(n?so(t,e,n):void 0===e)?1:iu(e),(Ra(t)?Vn:Vr)(t,e)},An.set=function(t,e,n){return null==t?t:Ur(t,e,n)},An.setWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:Ur(t,e,n,r)},An.shuffle=function(t){return(Ra(t)?Un:Qr)(t)},An.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&so(t,e,n)?(e=0,n=r):(e=null==e?0:iu(e),n=void 0===n?r:iu(n)),qr(t,e,n)):[]},An.sortBy=va,An.sortedUniq=function(t){return t&&t.length?Xr(t):[]},An.sortedUniqBy=function(t,e){return t&&t.length?Xr(t,Yi(e,2)):[]},An.split=function(t,e,n){return n&&"number"!=typeof n&&so(t,e,n)&&(e=n=void 0),(n=void 0===n?4294967295:n>>>0)?(t=su(t))&&("string"==typeof e||null!=e&&!$a(e))&&!(e=Jr(e))&&De(t)?li(He(t),0,n):t.split(e,n):[]},An.spread=function(t,e){if("function"!=typeof t)throw new yt(o);return e=null==e?0:un(iu(e),0),Lr((function(n){var r=n[e],i=li(n,0,e);return r&&pe(i,r),oe(t,this,i)}))},An.tail=function(t){var e=null==t?0:t.length;return e?qr(t,1,e):[]},An.take=function(t,e,n){return t&&t.length?qr(t,0,(e=n||void 0===e?1:iu(e))<0?0:e):[]},An.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?qr(t,(e=r-(e=n||void 0===e?1:iu(e)))<0?0:e,r):[]},An.takeRightWhile=function(t,e){return t&&t.length?ni(t,Yi(e,3),!1,!0):[]},An.takeWhile=function(t,e){return t&&t.length?ni(t,Yi(e,3)):[]},An.tap=function(t,e){return e(t),t},An.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new yt(o);return Wa(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),wa(t,e,{leading:r,maxWait:e,trailing:i})},An.thru=ra,An.toArray=nu,An.toPairs=Mu,An.toPairsIn=Au,An.toPath=function(t){return Ra(t)?de(t,zo):Ja(t)?[t]:gi(So(su(t)))},An.toPlainObject=uu,An.transform=function(t,e,n){var r=Ra(t),i=r||Na(t)||Ka(t);if(e=Yi(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:Wa(t)&&Va(o)?Cn(Ut(t)):{}}return(i?ue:cr)(t,(function(t,r,i){return e(n,t,r,i)})),n},An.unary=function(t){return ya(t,1)},An.union=Qo,An.unionBy=qo,An.unionWith=Ho,An.uniq=function(t){return t&&t.length?Kr(t):[]},An.uniqBy=function(t,e){return t&&t.length?Kr(t,Yi(e,2)):[]},An.uniqWith=function(t,e){return e="function"==typeof e?e:void 0,t&&t.length?Kr(t,void 0,e):[]},An.unset=function(t,e){return null==t||ti(t,e)},An.unzip=Zo,An.unzipWith=$o,An.update=function(t,e,n){return null==t?t:ei(t,e,ui(n))},An.updateWith=function(t,e,n,r){return r="function"==typeof r?r:void 0,null==t?t:ei(t,e,ui(n),r)},An.values=Cu,An.valuesIn=function(t){return null==t?[]:Te(t,xu(t))},An.without=Xo,An.words=Vu,An.wrap=function(t,e){return za(ui(e),t)},An.xor=Yo,An.xorBy=Jo,An.xorWith=Ko,An.zip=ta,An.zipObject=function(t,e){return oi(t||[],e||[],Wn)},An.zipObjectDeep=function(t,e){return oi(t||[],e||[],Ur)},An.zipWith=ea,An.entries=Mu,An.entriesIn=Au,An.extend=lu,An.extendWith=fu,Yu(An,An),An.add=us,An.attempt=Uu,An.camelCase=ku,An.capitalize=Tu,An.ceil=ss,An.clamp=function(t,e,n){return void 0===n&&(n=e,e=void 0),void 0!==n&&(n=(n=au(n))==n?n:0),void 0!==e&&(e=(e=au(e))==e?e:0),Xn(au(t),e,n)},An.clone=function(t){return Yn(t,4)},An.cloneDeep=function(t){return Yn(t,5)},An.cloneDeepWith=function(t,e){return Yn(t,5,e="function"==typeof e?e:void 0)},An.cloneWith=function(t,e){return Yn(t,4,e="function"==typeof e?e:void 0)},An.conformsTo=function(t,e){return null==e||Jn(t,e,wu(e))},An.deburr=Iu,An.defaultTo=function(t,e){return null==t||t!=t?e:t},An.divide=cs,An.endsWith=function(t,e,n){t=su(t),e=Jr(e);var r=t.length,i=n=void 0===n?r:Xn(iu(n),0,r);return(n-=e.length)>=0&&t.slice(n,i)==e},An.eq=Ca,An.escape=function(t){return(t=su(t))&&L.test(t)?t.replace(F,Ne):t},An.escapeRegExp=function(t){return(t=su(t))&&H.test(t)?t.replace(q,"\\$&"):t},An.every=function(t,e,n){var r=Ra(t)?ce:rr;return n&&so(t,e,n)&&(e=void 0),r(t,Yi(e,3))},An.find=aa,An.findIndex=Io,An.findKey=function(t,e){return be(t,Yi(e,3),cr)},An.findLast=ua,An.findLastIndex=Ro,An.findLastKey=function(t,e){return be(t,Yi(e,3),lr)},An.floor=ls,An.forEach=sa,An.forEachRight=ca,An.forIn=function(t,e){return null==t?t:ur(t,Yi(e,3),xu)},An.forInRight=function(t,e){return null==t?t:sr(t,Yi(e,3),xu)},An.forOwn=function(t,e){return t&&cr(t,Yi(e,3))},An.forOwnRight=function(t,e){return t&&lr(t,Yi(e,3))},An.get=mu,An.gt=ka,An.gte=Ta,An.has=function(t,e){return null!=t&&io(t,e,mr)},An.hasIn=yu,An.head=Bo,An.identity=Hu,An.includes=function(t,e,n,r){t=Ba(t)?t:Cu(t),n=n&&!r?iu(n):0;var i=t.length;return n<0&&(n=un(i+n,0)),Ya(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&we(t,e,n)>-1},An.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:iu(n);return i<0&&(i=un(r+i,0)),we(t,e,i)},An.inRange=function(t,e,n){return e=ru(e),void 0===n?(n=e,e=0):n=ru(n),function(t,e,n){return t>=sn(e,n)&&t<un(e,n)}(t=au(t),e,n)},An.invoke=_u,An.isArguments=Ia,An.isArray=Ra,An.isArrayBuffer=Pa,An.isArrayLike=Ba,An.isArrayLikeObject=Fa,An.isBoolean=function(t){return!0===t||!1===t||Qa(t)&&pr(t)==l},An.isBuffer=Na,An.isDate=La,An.isElement=function(t){return Qa(t)&&1===t.nodeType&&!Za(t)},An.isEmpty=function(t){if(null==t)return!0;if(Ba(t)&&(Ra(t)||"string"==typeof t||"function"==typeof t.splice||Na(t)||Ka(t)||Ia(t)))return!t.length;var e=ro(t);if(e==v||e==b)return!t.size;if(ho(t))return!Er(t).length;for(var n in t)if(jt.call(t,n))return!1;return!0},An.isEqual=function(t,e){return wr(t,e)},An.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===r?wr(t,e,void 0,n):!!r},An.isError=Da,An.isFinite=function(t){return"number"==typeof t&&rn(t)},An.isFunction=Va,An.isInteger=Ua,An.isLength=Ga,An.isMap=qa,An.isMatch=function(t,e){return t===e||xr(t,e,Ki(e))},An.isMatchWith=function(t,e,n){return n="function"==typeof n?n:void 0,xr(t,e,Ki(e),n)},An.isNaN=function(t){return Ha(t)&&t!=+t},An.isNative=function(t){if(fo(t))throw new $("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return jr(t)},An.isNil=function(t){return null==t},An.isNull=function(t){return null===t},An.isNumber=Ha,An.isObject=Wa,An.isObjectLike=Qa,An.isPlainObject=Za,An.isRegExp=$a,An.isSafeInteger=function(t){return Ua(t)&&t>=-9007199254740991&&t<=9007199254740991},An.isSet=Xa,An.isString=Ya,An.isSymbol=Ja,An.isTypedArray=Ka,An.isUndefined=function(t){return void 0===t},An.isWeakMap=function(t){return Qa(t)&&ro(t)==x},An.isWeakSet=function(t){return Qa(t)&&"[object WeakSet]"==pr(t)},An.join=function(t,e){return null==t?"":on.call(t,e)},An.kebabCase=Ru,An.last=Do,An.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return void 0!==n&&(i=(i=iu(n))<0?un(r+i,0):sn(i,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,i):_e(t,je,i,!0)},An.lowerCase=Pu,An.lowerFirst=Bu,An.lt=tu,An.lte=eu,An.max=function(t){return t&&t.length?ir(t,Hu,vr):void 0},An.maxBy=function(t,e){return t&&t.length?ir(t,Yi(e,2),vr):void 0},An.mean=function(t){return Oe(t,Hu)},An.meanBy=function(t,e){return Oe(t,Yi(e,2))},An.min=function(t){return t&&t.length?ir(t,Hu,zr):void 0},An.minBy=function(t,e){return t&&t.length?ir(t,Yi(e,2),zr):void 0},An.stubArray=os,An.stubFalse=as,An.stubObject=function(){return{}},An.stubString=function(){return""},An.stubTrue=function(){return!0},An.multiply=hs,An.nth=function(t,e){return t&&t.length?Tr(t,iu(e)):void 0},An.noConflict=function(){return Ht._===this&&(Ht._=Mt),this},An.noop=Ju,An.now=ma,An.pad=function(t,e,n){t=su(t);var r=(e=iu(e))?qe(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Ii(tn(i),n)+t+Ii(Ke(i),n)},An.padEnd=function(t,e,n){t=su(t);var r=(e=iu(e))?qe(t):0;return e&&r<e?t+Ii(e-r,n):t},An.padStart=function(t,e,n){t=su(t);var r=(e=iu(e))?qe(t):0;return e&&r<e?Ii(e-r,n)+t:t},An.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),ln(su(t).replace(Z,""),e||0)},An.random=function(t,e,n){if(n&&"boolean"!=typeof n&&so(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=ru(t),void 0===e?(e=t,t=0):e=ru(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=fn();return sn(t+i*(e-t+Gt("1e-"+((i+"").length-1))),e)}return Fr(t,e)},An.reduce=function(t,e,n){var r=Ra(t)?ve:ze,i=arguments.length<3;return r(t,Yi(e,4),n,i,er)},An.reduceRight=function(t,e,n){var r=Ra(t)?me:ze,i=arguments.length<3;return r(t,Yi(e,4),n,i,nr)},An.repeat=function(t,e,n){return e=(n?so(t,e,n):void 0===e)?1:iu(e),Nr(su(t),e)},An.replace=function(){var t=arguments,e=su(t[0]);return t.length<3?e:e.replace(t[1],t[2])},An.result=function(t,e,n){var r=-1,i=(e=si(e,t)).length;for(i||(i=1,t=void 0);++r<i;){var o=null==t?void 0:t[zo(e[r])];void 0===o&&(r=i,o=n),t=Va(o)?o.call(t):o}return t},An.round=ds,An.runInContext=t,An.sample=function(t){return(Ra(t)?Dn:Dr)(t)},An.size=function(t){if(null==t)return 0;if(Ba(t))return Ya(t)?qe(t):t.length;var e=ro(t);return e==v||e==b?t.size:Er(t).length},An.snakeCase=Fu,An.some=function(t,e,n){var r=Ra(t)?ye:Hr;return n&&so(t,e,n)&&(e=void 0),r(t,Yi(e,3))},An.sortedIndex=function(t,e){return Zr(t,e)},An.sortedIndexBy=function(t,e,n){return $r(t,e,Yi(n,2))},An.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=Zr(t,e);if(r<n&&Ca(t[r],e))return r}return-1},An.sortedLastIndex=function(t,e){return Zr(t,e,!0)},An.sortedLastIndexBy=function(t,e,n){return $r(t,e,Yi(n,2),!0)},An.sortedLastIndexOf=function(t,e){if(null==t?0:t.length){var n=Zr(t,e,!0)-1;if(Ca(t[n],e))return n}return-1},An.startCase=Nu,An.startsWith=function(t,e,n){return t=su(t),n=null==n?0:Xn(iu(n),0,t.length),e=Jr(e),t.slice(n,n+e.length)==e},An.subtract=ps,An.sum=function(t){return t&&t.length?Me(t,Hu):0},An.sumBy=function(t,e){return t&&t.length?Me(t,Yi(e,2)):0},An.template=function(t,e,n){var r=An.templateSettings;n&&so(t,e,n)&&(e=void 0),t=su(t),e=fu({},e,r,Vi);var i,o,a=fu({},e.imports,r.imports,Vi),u=wu(a),s=Te(a,u),c=0,l=e.interpolate||lt,f="__p += '",h=vt((e.escape||lt).source+"|"+l.source+"|"+(l===U?nt:lt).source+"|"+(e.evaluate||lt).source+"|$","g"),d="//# sourceURL="+(jt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Lt+"]")+"\n";t.replace(h,(function(e,n,r,a,u,s){return r||(r=a),f+=t.slice(c,s).replace(ft,Le),n&&(i=!0,f+="' +\n__e("+n+") +\n'"),u&&(o=!0,f+="';\n"+u+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=s+e.length,e})),f+="';\n";var p=jt.call(e,"variable")&&e.variable;if(p){if(tt.test(p))throw new $("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(o?f.replace(I,""):f).replace(R,"$1").replace(P,"$1;"),f="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var v=Uu((function(){return ht(u,d+"return "+f).apply(void 0,s)}));if(v.source=f,Da(v))throw v;return v},An.times=function(t,e){if((t=iu(t))<1||t>9007199254740991)return[];var n=4294967295,r=sn(t,4294967295);t-=4294967295;for(var i=Ae(r,e=Yi(e));++n<t;)e(n);return i},An.toFinite=ru,An.toInteger=iu,An.toLength=ou,An.toLower=function(t){return su(t).toLowerCase()},An.toNumber=au,An.toSafeInteger=function(t){return t?Xn(iu(t),-9007199254740991,9007199254740991):0===t?t:0},An.toString=su,An.toUpper=function(t){return su(t).toUpperCase()},An.trim=function(t,e,n){if((t=su(t))&&(n||void 0===e))return Ce(t);if(!t||!(e=Jr(e)))return t;var r=He(t),i=He(e);return li(r,Re(r,i),Pe(r,i)+1).join("")},An.trimEnd=function(t,e,n){if((t=su(t))&&(n||void 0===e))return t.slice(0,Ze(t)+1);if(!t||!(e=Jr(e)))return t;var r=He(t);return li(r,0,Pe(r,He(e))+1).join("")},An.trimStart=function(t,e,n){if((t=su(t))&&(n||void 0===e))return t.replace(Z,"");if(!t||!(e=Jr(e)))return t;var r=He(t);return li(r,Re(r,He(e))).join("")},An.truncate=function(t,e){var n=30,r="...";if(Wa(e)){var i="separator"in e?e.separator:i;n="length"in e?iu(e.length):n,r="omission"in e?Jr(e.omission):r}var o=(t=su(t)).length;if(De(t)){var a=He(t);o=a.length}if(n>=o)return t;var u=n-qe(r);if(u<1)return r;var s=a?li(a,0,u).join(""):t.slice(0,u);if(void 0===i)return s+r;if(a&&(u+=s.length-u),$a(i)){if(t.slice(u).search(i)){var c,l=s;for(i.global||(i=vt(i.source,su(rt.exec(i))+"g")),i.lastIndex=0;c=i.exec(l);)var f=c.index;s=s.slice(0,void 0===f?u:f)}}else if(t.indexOf(Jr(i),u)!=u){var h=s.lastIndexOf(i);h>-1&&(s=s.slice(0,h))}return s+r},An.unescape=function(t){return(t=su(t))&&N.test(t)?t.replace(B,$e):t},An.uniqueId=function(t){var e=++Ot;return su(t)+e},An.upperCase=Lu,An.upperFirst=Du,An.each=sa,An.eachRight=ca,An.first=Bo,Yu(An,(fs={},cr(An,(function(t,e){jt.call(An.prototype,e)||(fs[e]=t)})),fs),{chain:!1}),An.VERSION="4.17.21",ue(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){An[t].placeholder=An})),ue(["drop","take"],(function(t,e){In.prototype[t]=function(n){n=void 0===n?1:un(iu(n),0);var r=this.__filtered__&&!e?new In(this):this.clone();return r.__filtered__?r.__takeCount__=sn(n,r.__takeCount__):r.__views__.push({size:sn(n,4294967295),type:t+(r.__dir__<0?"Right":"")}),r},In.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),ue(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;In.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Yi(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),ue(["head","last"],(function(t,e){var n="take"+(e?"Right":"");In.prototype[t]=function(){return this[n](1).value()[0]}})),ue(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");In.prototype[t]=function(){return this.__filtered__?new In(this):this[n](1)}})),In.prototype.compact=function(){return this.filter(Hu)},In.prototype.find=function(t){return this.filter(t).head()},In.prototype.findLast=function(t){return this.reverse().find(t)},In.prototype.invokeMap=Lr((function(t,e){return"function"==typeof t?new In(this):this.map((function(n){return br(n,t,e)}))})),In.prototype.reject=function(t){return this.filter(Ea(Yi(t)))},In.prototype.slice=function(t,e){t=iu(t);var n=this;return n.__filtered__&&(t>0||e<0)?new In(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),void 0!==e&&(n=(e=iu(e))<0?n.dropRight(-e):n.take(e-t)),n)},In.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},In.prototype.toArray=function(){return this.take(4294967295)},cr(In.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=An[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);i&&(An.prototype[e]=function(){var e=this.__wrapped__,a=r?[1]:arguments,u=e instanceof In,s=a[0],c=u||Ra(e),l=function(t){var e=i.apply(An,pe([t],a));return r&&f?e[0]:e};c&&n&&"function"==typeof s&&1!=s.length&&(u=c=!1);var f=this.__chain__,h=!!this.__actions__.length,d=o&&!f,p=u&&!h;if(!o&&c){e=p?e:new In(this);var v=t.apply(e,a);return v.__actions__.push({func:ra,args:[l],thisArg:void 0}),new Tn(v,f)}return d&&p?t.apply(this,a):(v=this.thru(l),d?r?v.value()[0]:v.value():v)})})),ue(["pop","push","shift","sort","splice","unshift"],(function(t){var e=gt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);An.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(Ra(i)?i:[],t)}return this[n]((function(n){return e.apply(Ra(n)?n:[],t)}))}})),cr(In.prototype,(function(t,e){var n=An[e];if(n){var r=n.name+"";jt.call(_n,r)||(_n[r]=[]),_n[r].push({name:e,func:n})}})),_n[Ai(void 0,2).name]=[{name:"wrapper",func:void 0}],In.prototype.clone=function(){var t=new In(this.__wrapped__);return t.__actions__=gi(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=gi(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=gi(this.__views__),t},In.prototype.reverse=function(){if(this.__filtered__){var t=new In(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},In.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Ra(t),r=e<0,i=n?t.length:0,o=function(t,e,n){var r=-1,i=n.length;for(;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":t+=a;break;case"dropRight":e-=a;break;case"take":e=sn(e,t+a);break;case"takeRight":t=un(t,e-a)}}return{start:t,end:e}}(0,i,this.__views__),a=o.start,u=o.end,s=u-a,c=r?u:a-1,l=this.__iteratees__,f=l.length,h=0,d=sn(s,this.__takeCount__);if(!n||!r&&i==s&&d==s)return ri(t,this.__actions__);var p=[];t:for(;s--&&h<d;){for(var v=-1,m=t[c+=e];++v<f;){var y=l[v],g=y.iteratee,b=y.type,_=g(m);if(2==b)m=_;else if(!_){if(1==b)continue t;break t}}p[h++]=m}return p},An.prototype.at=ia,An.prototype.chain=function(){return na(this)},An.prototype.commit=function(){return new Tn(this.value(),this.__chain__)},An.prototype.next=function(){void 0===this.__values__&&(this.__values__=nu(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?void 0:this.__values__[this.__index__++]}},An.prototype.plant=function(t){for(var e,n=this;n instanceof kn;){var r=Ao(n);r.__index__=0,r.__values__=void 0,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e},An.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof In){var e=t;return this.__actions__.length&&(e=new In(this)),(e=e.reverse()).__actions__.push({func:ra,args:[Wo],thisArg:void 0}),new Tn(e,this.__chain__)}return this.thru(Wo)},An.prototype.toJSON=An.prototype.valueOf=An.prototype.value=function(){return ri(this.__wrapped__,this.__actions__)},An.prototype.first=An.prototype.head,Yt&&(An.prototype[Yt]=function(){return this}),An}();Ht._=Xe,void 0===(i=function(){return Xe}.call(e,n,e,r))||(r.exports=i)}).call(this)}).call(this,n(26),n(253)(t))},261:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.intersectBox=function(t){return t.intersectPoint(this)},t.prototype.intersectPoint=function(t){return t.x===this.x&&t.y===this.y},t}();e.Point=r},262:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e){this.data=t,this.position=e};e.Element=r},292:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(261);!function(t){t[t.TopLeft=0]="TopLeft",t[t.TopRight=1]="TopRight",t[t.BottomLeft=2]="BottomLeft",t[t.BottomRight=3]="BottomRight"}(r=e.SubQuad||(e.SubQuad={}));var o=function(){function t(t,e,n,r){this.x=t,this.y=e,this.w=n,this.h=r}return t.prototype.center=function(){return new i.Point(this.x+(this.w>>1),this.y+(this.h>>1))},t.prototype.intersectPoint=function(t){return this.x<=t.x&&t.x<=this.x+this.w&&this.y<=t.y&&t.y<=this.y+this.h},t.prototype.intersectBox=function(t){return!(t.x+t.w<=this.x||this.x+this.w<=t.x)&&!(t.y+t.h<=this.y||this.y+this.h<=t.y)},t.prototype.getSubQuad=function(t,e){var n=this.center();return t<n.x?e<n.y?r.TopLeft:r.BottomLeft:e<n.y?r.TopRight:r.BottomRight},t.prototype.getSubBox=function(e){var n=this.w>>1,i=this.h>>1;switch(e){case r.TopLeft:return new t(this.x,this.y,n,i);case r.TopRight:return new t(this.x+n,this.y,n,i);case r.BottomLeft:return new t(this.x,this.y+i,n,i);case r.BottomRight:default:return new t(this.x+n,this.y+i,n,i)}},t}();e.Box=o},293:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n){this.x=t,this.y=e,this.r=n}return t.prototype.intersectPoint=function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n<this.r*this.r},t.prototype.intersectBox=function(t){var e=this.clamp(this.x,t.x,t.x+t.w),n=this.clamp(this.y,t.y,t.y+t.h),r=this.x-e,i=this.y-n;return r*r+i*i<this.r*this.r},t.prototype.clamp=function(t,e,n){return t<e?e:t>n?n:t},t}();e.Circle=r},294:function(t,e,n){"use strict";var r=this&&this.__values||function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}},i=this&&this.__read||function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(u){i={error:u}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var a=n(295),u=n(262),s=n(296),c=n(297),l=function(){function t(t,e){void 0===e&&(e={threshold:8,maxDepth:8}),this.freeNode=-1,this.rect=t,this.threshold=e.threshold||8,this.maxDepth=e.maxDepth||8,this.elements=new s.FreeList,this.nodes=[new a.Node(0)]}return t.prototype.insert=function(t,e){var n=new c.MaterialNode(this.rect),r=this.selectNode(n,e.x,e.y);if(null!==r){this.shouldSplit(r)&&(this.split(r),r=this.selectNode(r,e.x,e.y));var i=new u.Element(t,e),o=this.elements.insert(i),a=this.nodes[r.nodeIndex];a.count++,i.next=a.firstChild,a.firstChild=o}},t.prototype.findInShape=function(t){for(var e,n,i=[new c.MaterialNode(this.rect)],o=[];i.length>0;){var a=i.pop(),u=this.nodes[a.nodeIndex];if(u.isLeaf())try{for(var s=(e=void 0,r(u.enumerateElements(this.elements))),l=s.next();!l.done;l=s.next()){var f=l.value;t.intersectPoint(f.position)&&o.push(f)}}catch(p){e={error:p}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}else for(var h=0;h<=3;h++){var d=a.rect.getSubBox(h);t.intersectBox(d)&&i.push(new c.MaterialNode(d,u.firstChild+h,a.depth+1))}}return o},t.prototype.split=function(t){for(var e,n=this.nodes[t.nodeIndex],r=[new a.Node(0),new a.Node(0),new a.Node(0),new a.Node(0)],i=n.firstChild,u=0;u<n.count;u++){var s=this.elements.get(i),c=s.next,l=r[t.rect.getSubQuad(s.position.x,s.position.y)];l.count>0&&(s.next=l.firstChild),l.count+=1,l.firstChild=i,i=c}n.firstChild=this.nodes.length,n.count=-1,(e=this.nodes).push.apply(e,o(r))},t.prototype.shouldSplit=function(t){return this.nodes[t.nodeIndex].count+1>this.threshold&&t.depth<this.maxDepth},t.prototype.selectNode=function(t,e,n){for(var r=[t];r.length>0;){var i=r.pop(),o=this.nodes[i.nodeIndex];if(o.isLeaf())return i;var a=i.rect.getSubQuad(e,n),u=i.rect.getSubBox(a);r.push(new c.MaterialNode(u,o.firstChild+a,i.depth+1))}return null},t}();e.Quadtree=l},295:function(t,e,n){"use strict";var r=this&&this.__generator||function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(u){o=[6,u],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t){this.firstChild=-1,this.count=-1,this.count=t}return t.prototype.isLeaf=function(){return this.count>=0},t.prototype.enumerateElements=function(t){var e,n;return r(this,(function(r){switch(r.label){case 0:e=this.firstChild,n=0,r.label=1;case 1:return n<this.count?[4,t.get(e)]:[3,4];case 2:r.sent(),e=t.get(e).next,r.label=3;case 3:return n++,[3,1];case 4:return[2]}}))},t}();e.Node=i},296:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){this.next=-1},i=function(){function t(){this.data=[],this.firstFree=-1}return t.prototype.get=function(t){return this.data[t].element},t.prototype.insert=function(t){if(-1!==this.firstFree){var e=this.firstFree;return this.firstFree=this.data[this.firstFree].next,this.data[e].element=t,e}var n=new r;return n.element=t,this.data.push(n),this.data.length-1},t.prototype.erase=function(t){this.data[t].next=this.firstFree,this.firstFree=t},t.prototype.clear=function(){this.data.length=0,this.firstFree=-1},t.prototype.size=function(){return this.data.length},t}();e.FreeList=i},297:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=0),this.rect=t,this.nodeIndex=e,this.depth=n};e.MaterialNode=r}}]);